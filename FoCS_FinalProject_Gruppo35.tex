
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{FoCS\_FinalProject\_Gruppo35}
    
    
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{universituxe0-degli-studi-di-milano-bicocca-masters-degree-in-data-science}{%
\section{\texorpdfstring{Università degli Studi di Milano Bicocca
Master's Degree in Data
Science}{Università degli Studi di Milano Bicocca   Master's Degree in Data Science}}\label{universituxe0-degli-studi-di-milano-bicocca-masters-degree-in-data-science}}

\hypertarget{final-project---foundation-of-computer-science-f9101q001}{%
\subsection{Final Project - Foundation of Computer Science
(F9101Q001)}\label{final-project---foundation-of-computer-science-f9101q001}}

    \textbf{Gruppo 35}: Daniele Rizzo \emph{872359} Carlo Salaorni
\emph{760080} Matteo Tarli \emph{800676}

Assignment Body

    Definizione delle librerie di interesse e i dataset di partenza. Le
librerie \texttt{Pandas} e \texttt{NumPy} saranno utilizzate per la
lettura ed elaborazione dei dataframe, mentre la libreria \texttt{re}
per l'uso dell'espressioni regolari. Verrà infine sfruttata la libreria
\texttt{time} per registrare il tempo di una run completa del codice.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{time}
        \PY{n}{start} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd} 
        \PY{k+kn}{import} \PY{n+nn}{re}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{times} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://github.com/DanieleRizz0/CSProject/raw/main/timesData.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{thousands} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{shangai} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://github.com/DanieleRizz0/CSProject/raw/main/shanghaiData.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cwur} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://github.com/DanieleRizz0/CSProject/raw/main/cwurData.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{times}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}   world\_rank                        university\_name                   country  \textbackslash{}
        0          1                     Harvard University  United States of America   
        1          2     California Institute of Technology  United States of America   
        2          3  Massachusetts Institute of Technology  United States of America   
        3          4                    Stanford University  United States of America   
        4          5                   Princeton University  United States of America   
        
           teaching international  research  citations income total\_score  \textbackslash{}
        0      99.7          72.4      98.7       98.8   34.5        96.1   
        1      97.7          54.6      98.0       99.9   83.7        96.0   
        2      97.8          82.3      91.4       99.9   87.5        95.6   
        3      98.3          29.5      98.1       99.2   64.3        94.3   
        4      90.9          70.3      95.4       99.9      -        94.2   
        
           num\_students  student\_staff\_ratio international\_students female\_male\_ratio  \textbackslash{}
        0       20152.0                  8.9                    25\%               NaN   
        1        2243.0                  6.9                    27\%           33 : 67   
        2       11074.0                  9.0                    33\%           37 : 63   
        3       15596.0                  7.8                    22\%           42 : 58   
        4        7929.0                  8.4                    27\%           45 : 55   
        
           year  
        0  2011  
        1  2011  
        2  2011  
        3  2011  
        4  2011  
\end{Verbatim}
            
    Si può notare che l'attributo \texttt{income} di interesse risulta
essere di tipo \texttt{object}. Al fine di correggere questa situazione
per utilizzi futuri di questa colonna si effettua una conversione in
tipo \texttt{numeric}.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{times}\PY{o}{.}\PY{n}{income}\PY{o}{.}\PY{n}{dtype}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} dtype('O')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{times}\PY{o}{.}\PY{n}{income} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{times}\PY{o}{.}\PY{n}{income}\PY{p}{,} \PY{n}{errors} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coerce}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{times}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:}   world\_rank                        university\_name                   country  \textbackslash{}
        0          1                     Harvard University  United States of America   
        1          2     California Institute of Technology  United States of America   
        2          3  Massachusetts Institute of Technology  United States of America   
        3          4                    Stanford University  United States of America   
        4          5                   Princeton University  United States of America   
        
           teaching international  research  citations  income total\_score  \textbackslash{}
        0      99.7          72.4      98.7       98.8    34.5        96.1   
        1      97.7          54.6      98.0       99.9    83.7        96.0   
        2      97.8          82.3      91.4       99.9    87.5        95.6   
        3      98.3          29.5      98.1       99.2    64.3        94.3   
        4      90.9          70.3      95.4       99.9     NaN        94.2   
        
           num\_students  student\_staff\_ratio international\_students female\_male\_ratio  \textbackslash{}
        0       20152.0                  8.9                    25\%               NaN   
        1        2243.0                  6.9                    27\%           33 : 67   
        2       11074.0                  9.0                    33\%           37 : 63   
        3       15596.0                  7.8                    22\%           42 : 58   
        4        7929.0                  8.4                    27\%           45 : 55   
        
           year  
        0  2011  
        1  2011  
        2  2011  
        3  2011  
        4  2011  
\end{Verbatim}
            
    Si noti che il record 4 presenta il valore \texttt{-} per l'attributo
income. L'argomento
\texttt{errors\ =\ \textquotesingle{}coerce\textquotesingle{}} quindi
viene utilizzato al fine di convertirlo in valore nullo.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{shangai}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:}   world\_rank                              university\_name national\_rank  \textbackslash{}
        0          1                           Harvard University             1   
        1          2                      University of Cambridge             1   
        2          3                          Stanford University             2   
        3          4           University of California, Berkeley             3   
        4          5  Massachusetts Institute of Technology (MIT)             4   
        
           total\_score  alumni  award   hici     ns    pub   pcp  year  
        0        100.0   100.0  100.0  100.0  100.0  100.0  72.4  2005  
        1         73.6    99.8   93.4   53.3   56.6   70.9  66.9  2005  
        2         73.4    41.1   72.2   88.5   70.9   72.3  65.0  2005  
        3         72.8    71.8   76.0   69.4   73.9   72.2  52.7  2005  
        4         70.1    74.0   80.6   66.7   65.8   64.3  53.0  2005  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{cwur}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}    world\_rank                            institution         country  \textbackslash{}
        0           1                     Harvard University             USA   
        1           2  Massachusetts Institute of Technology             USA   
        2           3                    Stanford University             USA   
        3           4                University of Cambridge  United Kingdom   
        4           5     California Institute of Technology             USA   
        
           national\_rank  quality\_of\_education  alumni\_employment  quality\_of\_faculty  \textbackslash{}
        0              1                     7                  9                   1   
        1              2                     9                 17                   3   
        2              3                    17                 11                   5   
        3              1                    10                 24                   4   
        4              4                     2                 29                   7   
        
           publications  influence  citations  broad\_impact  patents   score  year  
        0             1          1          1           NaN        5  100.00  2012  
        1            12          4          4           NaN        1   91.67  2012  
        2             4          2          2           NaN       15   89.50  2012  
        3            16         16         11           NaN       50   86.17  2012  
        4            37         22         22           NaN       18   85.21  2012  
\end{Verbatim}
            
    \hypertarget{for-each-university-extract-from-the-times-dataset-the-most-recent-and-the-least-recent-data-obtaining-two-separate-dataframes.}{%
\subsubsection{1. For each university, extract from the times dataset
the most recent and the least recent data, obtaining two separate
dataframes.}\label{for-each-university-extract-from-the-times-dataset-the-most-recent-and-the-least-recent-data-obtaining-two-separate-dataframes.}}

    L'obiettivo è ottenere due dataframe separati contenenti le informazioni
più e meno recenti per ogni università contenuti nel dataframe
\texttt{times}. Questo si può completare sfruttando i metodi di Pandas
\texttt{idxmax} e \texttt{idxmin} a seguito di un raggruppamento
rispetto al nome delle università. Questi metodi consentono di ottenere
le posizioni dei record relativi rispettivamente al valore massimo e
minimo. Una volta ottenuti questi indici è sufficiente sfruttare il
metodo \texttt{loc} per estrarre l'informazione corrispondente.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{new\PYZus{}times} \PY{o}{=} \PY{n}{times}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{times}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{o}{.}\PY{n}{idxmax}\PY{p}{(}\PY{p}{)}\PY{p}{]}
        \PY{n}{new\PYZus{}times}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:}      world\_rank                           university\_name         country  \textbackslash{}
        2405    601-800  AGH University of Science and Technology          Poland   
        2003    201-250                        Aalborg University         Denmark   
        2056    251-300                          Aalto University         Finland   
        1908       =106                         Aarhus University         Denmark   
        2105    301-350                    Aberystwyth University  United Kingdom   
        
              teaching international  research  citations  income total\_score  \textbackslash{}
        2405      14.2          17.9       3.7       35.7     NaN           -   
        2003      25.1          71.0      28.4       73.8    43.7           -   
        2056      31.1          65.4      32.8       62.1    61.6           -   
        1908      36.9          76.8      50.7       79.8    68.3        57.7   
        2105      21.6          72.2      18.9       67.2    31.3           -   
        
              num\_students  student\_staff\_ratio international\_students  \textbackslash{}
        2405       35569.0                 17.0                     1\%   
        2003       17422.0                 15.9                    15\%   
        2056       16099.0                 24.2                    17\%   
        1908       23895.0                 13.6                    14\%   
        2105        9252.0                 19.2                    18\%   
        
             female\_male\_ratio  year  
        2405                 -  2016  
        2003           48 : 52  2016  
        2056           32 : 68  2016  
        1908           54 : 46  2016  
        2105           48 : 52  2016  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{old\PYZus{}times} \PY{o}{=} \PY{n}{times}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{times}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{o}{.}\PY{n}{idxmin}\PY{p}{(}\PY{p}{)}\PY{p}{]}
         \PY{n}{old\PYZus{}times}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:}      world\_rank                           university\_name         country  \textbackslash{}
         2405    601-800  AGH University of Science and Technology          Poland   
         501     301-350                        Aalborg University         Denmark   
         502     301-350                          Aalto University         Finland   
         166         167                         Aarhus University         Denmark   
         476     276-300                    Aberystwyth University  United Kingdom   
         
               teaching international  research  citations  income total\_score  \textbackslash{}
         2405      14.2          17.9       3.7       35.7     NaN           -   
         501       19.0          75.3      20.0       27.1    36.4           -   
         502       26.2          49.0      22.2       37.5    61.9           -   
         166       38.1          33.4      55.6       57.3    61.5        49.9   
         476       19.8          63.8      15.5       56.6    35.5           -   
         
               num\_students  student\_staff\_ratio international\_students  \textbackslash{}
         2405       35569.0                 17.0                     1\%   
         501        17422.0                 15.9                    15\%   
         502        16099.0                 24.2                    17\%   
         166        23895.0                 13.6                    14\%   
         476         9252.0                 19.2                    18\%   
         
              female\_male\_ratio  year  
         2405                 -  2016  
         501            48 : 52  2012  
         502            32 : 68  2012  
         166            54 : 46  2011  
         476            48 : 52  2012  
\end{Verbatim}
            
    \hypertarget{for-each-university-compute-the-improvement-in-income-between-the-least-recent-and-the-most-recent-data-points.}{%
\subsubsection{2. For each university, compute the improvement in income
between the least recent and the most recent data
points.}\label{for-each-university-compute-the-improvement-in-income-between-the-least-recent-and-the-most-recent-data-points.}}

    L'idea è di performare una join dei dataset costruiti nel punto
precedente sul nome dell'università e di valutare da questa unione
l'eventuale differenza di reddito.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{merged} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{new\PYZus{}times}\PY{p}{,} \PY{n}{old\PYZus{}times}\PY{p}{,} \PY{n}{on} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{suffixes} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}new}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}old}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{merged}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:}   world\_rank\_new                           university\_name     country\_new  \textbackslash{}
         0        601-800  AGH University of Science and Technology          Poland   
         1        201-250                        Aalborg University         Denmark   
         2        251-300                          Aalto University         Finland   
         3           =106                         Aarhus University         Denmark   
         4        301-350                    Aberystwyth University  United Kingdom   
         
            teaching\_new international\_new  research\_new  citations\_new  income\_new  \textbackslash{}
         0          14.2              17.9           3.7           35.7         NaN   
         1          25.1              71.0          28.4           73.8        43.7   
         2          31.1              65.4          32.8           62.1        61.6   
         3          36.9              76.8          50.7           79.8        68.3   
         4          21.6              72.2          18.9           67.2        31.3   
         
           total\_score\_new  num\_students\_new  {\ldots}  international\_old research\_old  \textbackslash{}
         0               -           35569.0  {\ldots}               17.9          3.7   
         1               -           17422.0  {\ldots}               75.3         20.0   
         2               -           16099.0  {\ldots}               49.0         22.2   
         3            57.7           23895.0  {\ldots}               33.4         55.6   
         4               -            9252.0  {\ldots}               63.8         15.5   
         
           citations\_old  income\_old total\_score\_old num\_students\_old  \textbackslash{}
         0          35.7         NaN               -          35569.0   
         1          27.1        36.4               -          17422.0   
         2          37.5        61.9               -          16099.0   
         3          57.3        61.5            49.9          23895.0   
         4          56.6        35.5               -           9252.0   
         
            student\_staff\_ratio\_old international\_students\_old  female\_male\_ratio\_old  \textbackslash{}
         0                     17.0                         1\%                      -   
         1                     15.9                        15\%                48 : 52   
         2                     24.2                        17\%                32 : 68   
         3                     13.6                        14\%                54 : 46   
         4                     19.2                        18\%                48 : 52   
         
            year\_old  
         0      2016  
         1      2012  
         2      2012  
         3      2011  
         4      2012  
         
         [5 rows x 27 columns]
\end{Verbatim}
            
    E' importante individuare eventuali valori mancanti in queste colonne
prima di effettuare il calcolo della variazione del reddito. Questa
operazione si può effettuare con il comando \texttt{all}, il quale
restituisce \texttt{False} se anche un solo valore della serie è nullo.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{merged}\PY{o}{.}\PY{n}{income\PYZus{}new}\PY{o}{.}\PY{n}{notna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{all}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} False
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{merged}\PY{o}{.}\PY{n}{income\PYZus{}old}\PY{o}{.}\PY{n}{notna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{all}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} False
\end{Verbatim}
            
    In entrambi i dataframe sono presenti valori nulli. Al fine di risolvere
questa problematica si opta per un'operazione di rimozione dei record
con valori mancanti.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{merged}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{income\PYZus{}new}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{income\PYZus{}old}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{merged}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{improvement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{merged}\PY{o}{.}\PY{n}{income\PYZus{}new} \PY{o}{\PYZhy{}} \PY{n}{merged}\PY{o}{.}\PY{n}{income\PYZus{}old} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{merged}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{improvement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:}               university\_name  improvement
         1          Aalborg University          7.3
         2            Aalto University         -0.3
         3           Aarhus University          6.8
         4      Aberystwyth University         -4.2
         5  Adam Mickiewicz University          0.0
\end{Verbatim}
            
    \hypertarget{find-the-university-with-the-largest-increase-computed-in-the-previous-point.}{%
\subsubsection{3. Find the university with the largest increase computed
in the previous
point.}\label{find-the-university-with-the-largest-increase-computed-in-the-previous-point.}}

    Per individuare l'università con la maggiore crescita si può sfruttare
nuovamente il metodo \texttt{idxmax} con riferimento alla colonna
\texttt{improvement}. E' doveroso però effettuare un controllo per
evitare l'evenienza in cui più università presentino il medesimo
miglioramento. Per questa operazione si effettua un ordinamento in base
al miglioramento e si controllano eventuali valori massimi ripetuti.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{merged}\PY{o}{.}\PY{n}{improvement}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} 428    67.8
         278    59.9
         230    59.6
         205    59.5
         276    58.3
         573    58.2
         555    54.2
         497    54.1
         434    54.0
         712    51.6
         783    51.3
         222    50.1
         691    50.0
         293    49.3
         501    44.7
         223    44.5
         249    42.6
         392    42.4
         368    41.5
         738    41.4
         549    41.2
         563    39.7
         269    38.9
         420    38.2
         246    37.2
         808    35.5
         613    34.1
         777    33.8
         212    32.9
         154    32.6
                {\ldots} 
         138   -12.5
         772   -13.7
         176   -14.4
         718   -15.1
         87    -15.7
         715   -18.4
         291   -18.7
         780   -21.0
         779   -21.3
         144   -21.4
         200   -21.9
         642   -22.7
         348   -25.1
         186   -27.0
         567   -29.4
         287   -31.5
         365   -33.3
         193   -36.0
         215   -36.5
         684   -36.9
         596   -37.0
         171   -39.2
         704   -39.9
         177   -40.7
         115   -42.5
         435   -45.5
         587   -47.4
         237   -50.2
         491   -51.8
         414   -64.9
         Name: improvement, Length: 704, dtype: float64
\end{Verbatim}
            
    L'università \emph{TU Dresden} risulta essere quella che ha registrato
un maggiore incremento nel livello di reddito nel periodo di analisi
(pari a 67.8).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{merged}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{merged}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{improvement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{idxmax}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:} world\_rank\_new                      =158
         university\_name               TU Dresden
         country\_new                      Germany
         teaching\_new                        41.4
         international\_new                   47.7
         research\_new                        45.8
         citations\_new                       66.1
         income\_new                          99.7
         total\_score\_new                     52.1
         num\_students\_new                   35487
         student\_staff\_ratio\_new             37.4
         international\_students\_new           12\%
         female\_male\_ratio\_new            42 : 58
         year\_new                            2016
         world\_rank\_old                   251-275
         country\_old                      Germany
         teaching\_old                        27.3
         international\_old                   49.2
         research\_old                        13.8
         citations\_old                       57.4
         income\_old                          31.9
         total\_score\_old                        -
         num\_students\_old                   35487
         student\_staff\_ratio\_old             37.4
         international\_students\_old           12\%
         female\_male\_ratio\_old            42 : 58
         year\_old                            2012
         improvement                         67.8
         Name: 428, dtype: object
\end{Verbatim}
            
    \hypertarget{for-each-ranking-consider-only-the-most-recent-data-point.-for-each-university-compute-the-maximum-difference-between-the-rankings-e.g.for-aarhus-university-the-value-is-122-7349.-notice-that-some-rankings-are-expressed-as-a-range.}{%
\subsubsection{4. For each ranking, consider only the most recent data
point. For each university, compute the maximum difference between the
rankings (e.g.~for Aarhus University the value is 122-73=49). Notice
that some rankings are expressed as a
range.}\label{for-each-ranking-consider-only-the-most-recent-data-point.-for-each-university-compute-the-maximum-difference-between-the-rankings-e.g.for-aarhus-university-the-value-is-122-7349.-notice-that-some-rankings-are-expressed-as-a-range.}}

    Nei ranking sono presenti alcuni problemi di eterogeneità relativi al
nome delle università. Per esempio nel ranking \texttt{shangai}
l'università \emph{Massachusetts Institute of Technology} viene
indentificata anche con la nota sigla \emph{MIT} tra parentesi. Per
questo motivo, prima di operare al fine di dare una risposta al quesito,
è necessario normalizzare i nomi delle università nei diversi ranking.
Le operazioni che svolgeremo saranno volte a rendere tutte le stringhe
minuscole e ad eliminare eventuali parentesi.

Infine, nel dataframe \texttt{times}, alcuni record hanno un valore
della posizione preceduta da un segno \texttt{=} che va necessariamente
eliminato per poter trattare tutte le posizioni come valori numerici.

Per svolgere queste operazioni sfrutteremo sia le espressioni regolari
fornite dalla libreria \texttt{re}, sia i metodi associati alle
stringhe.

    Per prima cosa si procedere alla compilazione dell'espressione regolare
che verrà usata per gestire gli intervalli di valori.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{src} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{(?P\PYZlt{}first\PYZgt{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d+)}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s*\PYZhy{}*}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s*(?P\PYZlt{}second\PYZgt{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d*)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \texttt{times}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{times}\PY{o}{.}\PY{n}{university\PYZus{}name} \PY{o}{=} \PY{n}{times}\PY{o}{.}\PY{n}{university\PYZus{}name}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}
         \PY{n}{times}\PY{o}{.}\PY{n}{university\PYZus{}name}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} 0                       harvard university
         1       california institute of technology
         2    massachusetts institute of technology
         3                      stanford university
         4                     princeton university
         Name: university\_name, dtype: object
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{times}\PY{o}{.}\PY{n}{world\PYZus{}rank} \PY{o}{=} \PY{n}{times}\PY{o}{.}\PY{n}{world\PYZus{}rank}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{times}\PY{o}{.}\PY{n}{world\PYZus{}rank}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} 0             1
         1             2
         2             3
         3             4
         4             5
         5             6
         6             6
         7             8
         8             9
         9            10
         10           11
         11           12
         12           13
         13           14
         14           15
         15           15
         16           17
         17           18
         18           19
         19           20
         20           21
         21           22
         22           23
         23           24
         24           25
         25           26
         26           27
         27           28
         28           29
         29           30
                  {\ldots}   
         2573    601-800
         2574    601-800
         2575    601-800
         2576    601-800
         2577    601-800
         2578    601-800
         2579    601-800
         2580    601-800
         2581    601-800
         2582    601-800
         2583    601-800
         2584    601-800
         2585    601-800
         2586    601-800
         2587    601-800
         2588    601-800
         2589    601-800
         2590    601-800
         2591    601-800
         2592    601-800
         2593    601-800
         2594    601-800
         2595    601-800
         2596    601-800
         2597    601-800
         2598    601-800
         2599    601-800
         2600    601-800
         2601    601-800
         2602    601-800
         Name: world\_rank, Length: 2603, dtype: object
\end{Verbatim}
            
    \texttt{shangai}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{shangai}\PY{o}{.}\PY{n}{university\PYZus{}name} \PY{o}{=} \PY{n}{shangai}\PY{o}{.}\PY{n}{university\PYZus{}name}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}
         \PY{n}{shangai}\PY{o}{.}\PY{n}{university\PYZus{}name}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} 0                             harvard university
         1                        university of cambridge
         2                            stanford university
         3             university of california, berkeley
         4    massachusetts institute of technology (mit)
         Name: university\_name, dtype: object
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{shangai}\PY{o}{.}\PY{n}{university\PYZus{}name} \PY{o}{=} \PY{n}{shangai}\PY{o}{.}\PY{n}{university\PYZus{}name}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{(}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{w+}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{regex} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{shangai}\PY{o}{.}\PY{n}{university\PYZus{}name}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} 0                        harvard university
         1                   university of cambridge
         2                       stanford university
         3        university of california, berkeley
         4    massachusetts institute of technology 
         Name: university\_name, dtype: object
\end{Verbatim}
            
    \texttt{cwur}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{cwur}\PY{o}{.}\PY{n}{institution} \PY{o}{=} \PY{n}{cwur}\PY{o}{.}\PY{n}{institution}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}
         \PY{n}{cwur}\PY{o}{.}\PY{n}{institution}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} 0                       harvard university
         1    massachusetts institute of technology
         2                      stanford university
         3                  university of cambridge
         4       california institute of technology
         Name: institution, dtype: object
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{cwur}\PY{o}{.}\PY{n}{institution} \PY{o}{=} \PY{n}{cwur}\PY{o}{.}\PY{n}{institution}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{(}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{w+}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{)\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{regex} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{cwur}\PY{o}{.}\PY{n}{institution}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} 0                       harvard university
         1    massachusetts institute of technology
         2                      stanford university
         3                  university of cambridge
         4       california institute of technology
         Name: institution, dtype: object
\end{Verbatim}
            
    A questo punto è possibile proseguire con le operazioni. Per prima cosa
individuiamo l'anno più recente contenuto nei diversi ranking ed andiamo
ad integrarli ai precedenti dataset considerando come chiave il nome
dell'università.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{times\PYZus{}years} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{times}\PY{o}{.}\PY{n}{year}\PY{p}{)}
         \PY{n}{times\PYZus{}years}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:} \{2011, 2012, 2013, 2014, 2015, 2016\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{shangai\PYZus{}years} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{shangai}\PY{o}{.}\PY{n}{year}\PY{p}{)}
         \PY{n}{shangai\PYZus{}years}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:} \{2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{cwur\PYZus{}years} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{cwur}\PY{o}{.}\PY{n}{year}\PY{p}{)}
         \PY{n}{cwur\PYZus{}years}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} \{2012, 2013, 2014, 2015\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{rank} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{times}\PY{p}{[}\PY{n}{times}\PY{o}{.}\PY{n}{year} \PY{o}{==} \PY{n+nb}{max}\PY{p}{(}\PY{n}{times\PYZus{}years}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}suffix}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}times}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{shangai}\PY{p}{[}\PY{n}{shangai}\PY{o}{.}\PY{n}{year} \PY{o}{==} \PY{n+nb}{max}\PY{p}{(}\PY{n}{shangai\PYZus{}years}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}suffix}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}shangai}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name\PYZus{}times}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name\PYZus{}shangai}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{rank} \PY{o}{=} \PY{n}{rank}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{cwur}\PY{p}{[}\PY{n}{cwur}\PY{o}{.}\PY{n}{year} \PY{o}{==} \PY{n+nb}{max}\PY{p}{(}\PY{n}{cwur\PYZus{}years}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}suffix}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}cwur}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{institution\PYZus{}cwur}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{left\PYZus{}on} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name\PYZus{}times}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{rank}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name\PYZus{}times}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}

    E' necessario osservare che nei dataset \texttt{shangai} e
\texttt{times} il ranking è espresso non soltanto con valori puntuali ma
anche per mezzo di intervalli. Quest'ultimi verranno elaborati in modo
tale da ottenere il valore centrale degli stessi, così da poter
verificare infine la massima differenza tra le varie posizioni.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rank}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{fnd} \PY{o}{=} \PY{n}{src}\PY{o}{.}\PY{n}{search}\PY{p}{(}\PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{k}{if} \PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{second}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:} 
                 \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n+nb}{int}\PY{p}{(}\PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{second}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{else}\PY{p}{:}
                  \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rank}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{fnd} \PY{o}{=} \PY{n}{src}\PY{o}{.}\PY{n}{search}\PY{p}{(}\PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{k}{if} \PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{second}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:} 
                 \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n+nb}{int}\PY{p}{(}\PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{second}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}
             \PY{k}{else}\PY{p}{:}
                  \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{fnd}\PY{o}{.}\PY{n}{group}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{rank}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:} Index(['world\_rank\_times', 'university\_name', 'country\_times',
                'teaching\_times', 'international\_times', 'research\_times',
                'citations\_times', 'income\_times', 'total\_score\_times',
                'num\_students\_times', 'student\_staff\_ratio\_times',
                'international\_students\_times', 'female\_male\_ratio\_times', 'year\_times',
                'world\_rank\_shangai', 'university\_name\_shangai',
                'national\_rank\_shangai', 'total\_score\_shangai', 'alumni\_shangai',
                'award\_shangai', 'hici\_shangai', 'ns\_shangai', 'pub\_shangai',
                'pcp\_shangai', 'year\_shangai', 'world\_rank\_cwur', 'institution\_cwur',
                'country\_cwur', 'national\_rank\_cwur', 'quality\_of\_education\_cwur',
                'alumni\_employment\_cwur', 'quality\_of\_faculty\_cwur',
                'publications\_cwur', 'influence\_cwur', 'citations\_cwur',
                'broad\_impact\_cwur', 'patents\_cwur', 'score\_cwur', 'year\_cwur',
                'world\_rank\_shangai\_2', 'world\_rank\_times\_2'],
               dtype='object')
\end{Verbatim}
            
    Il dataframe così costruito presenta un'ampia complessità dovuta alla
grande quantità di colonne. Ma solo tre di queste sono di nostro
interesse:
\texttt{world\_rank\_times\_2},\texttt{world\_rank\_shangai\_2},
\texttt{world\_rank\_cwur}. Si noti che per distinguere il
posizionamento espresso come intervallo da quello puntuale, per i primi
due ranking, è stato aggiunto il suffisso \texttt{\_2}.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{rank}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}cwur}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:}      world\_rank\_times\_2  world\_rank\_shangai\_2  world\_rank\_cwur
         0                   1.0                   7.0               12
         1                   2.0                  10.0                5
         2                   3.0                   2.0                2
         3                   4.0                   5.0                4
         4                   6.0                   1.0                1
         5                   7.0                   6.0                9
         6                  10.0                   9.0                8
         7                  11.0                  16.0               16
         8                  12.0                  11.0               11
         9                  13.0                   4.0                7
         10                 14.0                  18.0               27
         11                 15.0                   8.0                6
         12                 16.0                  12.0               15
         13                 17.0                  17.0               14
         14                 18.0                  13.0               10
         15                 19.0                  25.0               32
         16                 20.0                  31.0               28
         17                 22.0                  61.0               61
         18                 25.0                  27.0               22
         19                 26.0                 125.5               65
         20                 28.0                  48.0               71
         21                 30.0                  27.0               18
         22                 34.0                  40.0               62
         23                 38.0                  64.0               42
         24                 39.0                  14.0               21
         25                 39.0                  38.0               64
         26                 41.0                 125.5               80
         27                 42.0                 125.5               56
         28                 44.0                  57.0               53
         29                 47.0                 125.5               78
         ..                  {\ldots}                   {\ldots}              {\ldots}
         268               550.5                 450.5              803
         269               550.5                 450.5              452
         270               550.5                 450.5              475
         271               550.5                 450.5              398
         272               550.5                 350.5              439
         273               550.5                 350.5              331
         274               550.5                 350.5              420
         275               550.5                 350.5              462
         276               550.5                 450.5              484
         277               700.5                 450.5              459
         278               700.5                 350.5              726
         279               700.5                 450.5              796
         280               700.5                 450.5              788
         281               700.5                 450.5              563
         282               700.5                 350.5              418
         283               700.5                 450.5              483
         284               700.5                 350.5              305
         285               700.5                 450.5              526
         286               700.5                 450.5              583
         287               700.5                 450.5              623
         288               700.5                 350.5              451
         289               700.5                 250.5              391
         290               700.5                 350.5              320
         291               700.5                 450.5              307
         292               700.5                 450.5              504
         293               700.5                 450.5              245
         294               700.5                 350.5              440
         295               700.5                 350.5              479
         296               700.5                 450.5              731
         297               700.5                 250.5              768
         
         [298 rows x 3 columns]
\end{Verbatim}
            
    Con le informazioni contenute del dataframe precedente è possibile
computare le differenze di classifica e selezionare così quella massima
tra i diversi ranking.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rank}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}cwur}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{rank}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}cwur}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{rank}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}times\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}shangai\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}cwur}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:}                                    university\_name  world\_rank\_times\_2  \textbackslash{}
         162                      king abdulaziz university               275.5   
         297                           university of tehran               700.5   
         265                                keio university               550.5   
         293                             okayama university               700.5   
         289                               jilin university               700.5   
         284                dalian university of technology               700.5   
         266                           king saud university               550.5   
         291                  kyungpook national university               700.5   
         290                                kobe university               700.5   
         278                         university of belgrade               700.5   
         268                national sun yat-sen university               550.5   
         234                              kyushu university               450.5   
         294             polytechnic university of valencia               700.5   
         282                               chiba university               700.5   
         295                             sichuan university               700.5   
         288                        jagiellonian university               700.5   
         168            queensland university of technology               275.5   
         279                               cairo university               700.5   
         224                              curtin university               450.5   
         157                            flinders university               275.5   
         124                             aalborg university               225.5   
         280                     capital medical university               700.5   
         214             swinburne university of technology               375.5   
         158                            griffith university               275.5   
         111                         university of konstanz               175.0   
         185                            university of essex               325.5   
         267                           university of lisbon               550.5   
         260                 harbin institute of technology               550.5   
         262  huazhong university of science and technology               550.5   
         81                            lancaster university               130.0   
         ..                                             {\ldots}                 {\ldots}   
         24             university of california, san diego                39.0   
         212                     san diego state university               375.5   
         193                           university of oregon               325.5   
         35     university of north carolina at chapel hill                63.0   
         60                       michigan state university                99.0   
         39               university of southern california                68.0   
         91                        university of nottingham               143.0   
         28                 university of california, davis                44.0   
         10                       university college london                14.0   
         15                           university of toronto                19.0   
         21                             new york university                30.0   
         16                                 duke university                20.0   
         0               california institute of technology                 1.0   
         36                               boston university                64.0   
         11                             columbia university                15.0   
         79                     radboud university nijmegen               125.0   
         9               university of california, berkeley                13.0   
         1                             university of oxford                 2.0   
         14                              cornell university                18.0   
         241                            university of parma               450.5   
         18                         northwestern university                25.0   
         7                         johns hopkins university                11.0   
         4                               harvard university                 6.0   
         12           university of california, los angeles                16.0   
         13                      university of pennsylvania                17.0   
         5                             princeton university                 7.0   
         6                            university of chicago                10.0   
         8                                  yale university                12.0   
         3                          university of cambridge                 4.0   
         2                              stanford university                 3.0   
         
              world\_rank\_shangai\_2  world\_rank\_cwur  max\_diff  
         162                 175.5              995     819.5  
         297                 250.5              768     517.5  
         265                 350.5               34     516.5  
         293                 450.5              245     455.5  
         289                 250.5              391     450.0  
         284                 350.5              305     395.5  
         266                 175.5              569     393.5  
         291                 450.5              307     393.5  
         290                 350.5              320     380.5  
         278                 350.5              726     375.5  
         268                 450.5              803     352.5  
         234                 250.5              100     350.5  
         294                 350.5              440     350.0  
         282                 350.5              418     350.0  
         295                 350.5              479     350.0  
         288                 350.5              451     350.0  
         168                 450.5              621     345.5  
         279                 450.5              796     345.5  
         224                 250.5              595     344.5  
         157                 350.5              620     344.5  
         124                 350.5              565     339.5  
         280                 450.5              788     337.5  
         214                 350.5              688     337.5  
         158                 350.5              613     337.5  
         111                 450.5              490     315.0  
         185                 450.5              632     306.5  
         267                 250.5              257     300.0  
         260                 250.5              410     300.0  
         262                 250.5              400     300.0  
         81                  350.5              426     296.0  
         ..                    {\ldots}              {\ldots}       {\ldots}  
         24                   14.0               21      25.0  
         212                 350.5              361      25.0  
         193                 350.5              339      25.0  
         35                   39.0               40      24.0  
         60                   99.0              118      19.0  
         39                   49.0               51      19.0  
         91                  125.5              140      17.5  
         28                   57.0               53      13.0  
         10                   18.0               27      13.0  
         15                   25.0               32      13.0  
         21                   27.0               18      12.0  
         16                   31.0               28      11.0  
         0                     7.0               12      11.0  
         36                   73.0               66       9.0  
         11                    8.0                6       9.0  
         79                  125.5              134       9.0  
         9                     4.0                7       9.0  
         1                    10.0                5       8.0  
         14                   13.0               10       8.0  
         241                 450.5              456       5.5  
         18                   27.0               22       5.0  
         7                    16.0               16       5.0  
         4                     1.0                1       5.0  
         12                   12.0               15       4.0  
         13                   17.0               14       3.0  
         5                     6.0                9       3.0  
         6                     9.0                8       2.0  
         8                    11.0               11       1.0  
         3                     5.0                4       1.0  
         2                     2.0                2       1.0  
         
         [298 rows x 5 columns]
\end{Verbatim}
            
    Per validare il risultato dell'operazione effettuiamo un confronto col
valore dell'università \texttt{Aarhus\ university} (max\_diff =
\textbf{49}).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{rank}\PY{p}{[}\PY{n}{rank}\PY{o}{.}\PY{n}{university\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aarhus university}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max\PYZus{}diff}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}36}]:} 65    49.0
         Name: max\_diff, dtype: float64
\end{Verbatim}
            
    \hypertarget{consider-only-the-most-recent-data-point-of-the-times-dataset.-compute-the-number-of-male-and-female-students-for-each-country.}{%
\subsubsection{5. Consider only the most recent data point of the times
dataset. Compute the number of male and female students for each
country.}\label{consider-only-the-most-recent-data-point-of-the-times-dataset.-compute-the-number-of-male-and-female-students-for-each-country.}}

    Per prima cosa estraiamo i dati più recenti dal dataframe
\texttt{times}. Si effettua quindi una copia del dataframe in modo da
operare in maggiore libertà sul subset. In questo caso non è un problema
dato che la dimensione del dataframe originale non è tale da rendere la
copia svantaggiosa.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{recent\PYZus{}times} \PY{o}{=} \PY{n}{times}\PY{p}{[}\PY{n}{times}\PY{o}{.}\PY{n}{year} \PY{o}{==} \PY{n+nb}{max}\PY{p}{(}\PY{n}{times\PYZus{}years}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{recent\PYZus{}times}\PY{o}{.}\PY{n}{female\PYZus{}male\PYZus{}ratio}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:} True
\end{Verbatim}
            
    Essendo presente un valore nullo si opta anche in questo caso per una
rimozione di tale valore. Si effettua anche un controllo sui rapporti
definiti come stringhe per verificare siano tutti validi.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{recent\PYZus{}times}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female\PYZus{}male\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{recent\PYZus{}times} \PY{o}{=} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female\PYZus{}male\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d+}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s*:}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{s*}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{d+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{recent\PYZus{}times}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:}      world\_rank                        university\_name  \textbackslash{}
         1803          1     california institute of technology   
         1804          2                   university of oxford   
         1805          3                    stanford university   
         1806          4                university of cambridge   
         1807          5  massachusetts institute of technology   
         
                                country  teaching international  research  citations  \textbackslash{}
         1803  United States of America      95.6          64.0      97.6       99.8   
         1804            United Kingdom      86.5          94.4      98.9       98.8   
         1805  United States of America      92.5          76.3      96.2       99.9   
         1806            United Kingdom      88.2          91.5      96.7       97.0   
         1807  United States of America      89.4          84.0      88.6       99.7   
         
               income total\_score  num\_students  student\_staff\_ratio  \textbackslash{}
         1803    97.8        95.2        2243.0                  6.9   
         1804    73.1        94.2       19919.0                 11.6   
         1805    63.3        93.9       15596.0                  7.8   
         1806    55.0        92.8       18812.0                 11.8   
         1807    95.4        92.0       11074.0                  9.0   
         
              international\_students female\_male\_ratio  year  
         1803                    27\%           33 : 67  2016  
         1804                    34\%           46 : 54  2016  
         1805                    22\%           42 : 58  2016  
         1806                    34\%           46 : 54  2016  
         1807                    33\%           37 : 63  2016  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}students}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dtype}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} dtype('float64')
\end{Verbatim}
            
    Si effettua ora una conversione numerica del rapporto
\(\frac{femmina}{maschio}\) a partire dalla colonna di stringhe e
successivamente si calcolano il numero di maschi e femmine sfruttando il
numero di studenti totale.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{male}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{p}{(}\PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female\PYZus{}male\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{expand} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{int}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{100}\PY{p}{)}\PY{o}{.}\PY{n}{mul}\PY{p}{(}\PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}students}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{male}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{male}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:}         female      male
         2227   17625.0       0.0
         1915     129.0     333.0
         2036    1401.0     418.0
         1983     269.0     500.0
         2037    1317.0     538.0
         2123     581.0     630.0
         2176    1914.0     943.0
         2030    1845.0     993.0
         2116     348.0    1046.0
         2089    1360.0    1113.0
         2013    1087.0    1131.0
         1999    1804.0    1154.0
         2043    2599.0    1280.0
         1856    1104.0    1296.0
         2290    1465.0    1407.0
         1803     740.0    1503.0
         2556    2095.0    1580.0
         2183    1068.0    1671.0
         2578     883.0    1714.0
         2263    2571.0    1787.0
         2106    2034.0    1803.0
         2062    3732.0    1838.0
         2490    2057.0    1898.0
         2582     194.0    1959.0
         1904     437.0    1992.0
         2156    4747.0    2133.0
         2075    2334.0    2154.0
         2398    7008.0    2213.0
         1830    5442.0    2332.0
         2262    2158.0    2338.0
         {\ldots}        {\ldots}       {\ldots}
         2389   13675.0   27763.0
         2057   43767.0   27982.0
         2104   19478.0   28030.0
         2572   13280.0   28220.0
         2440    6767.0   28850.0
         1944   27910.0   29049.0
         2386   35712.0   29219.0
         2022   33108.0   29360.0
         2573   24211.0   29591.0
         2267   46777.0   29906.0
         2506   25788.0   30272.0
         2222   53642.0   32877.0
         2557   31217.0   33818.0
         2592   18311.0   34005.0
         2487   30178.0   35427.0
         2005   47898.0   37634.0
         2332   19462.0   37780.0
         2423   58181.0   38787.0
         2518   67191.0   41182.0
         2456   21323.0   41393.0
         1991   41618.0   41618.0
         2092   39073.0   42329.0
         2512   29070.0   43606.0
         2485   36122.0   45974.0
         2038   71382.0   49604.0
         2259   70063.0   67315.0
         2408   58618.0   68813.0
         2562  128116.0   68986.0
         2413  295800.0   83431.0
         2430  109012.0  122929.0
         
         [736 rows x 2 columns]
\end{Verbatim}
            
    A questo punto è sufficiente raggruppare per la nazione e sommare il
numero di studenti maschili e femminili per ognuna di queste, ottenendo
quindi il nostro risultato.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{male}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:}                              female       male
         country                                       
         Argentina                   67191.0    41182.0
         Australia                  391736.0   321640.0
         Austria                     68364.0    66113.0
         Bangladesh                  21323.0    41393.0
         Belarus                     20219.0     9084.0
         Belgium                     92920.0    76741.0
         Brazil                     247271.0   246980.0
         Canada                     344440.0   279188.0
         Chile                       37962.0    52989.0
         China                      412261.0   552630.0
         Colombia                    26376.0    28269.0
         Cyprus                       4747.0     2133.0
         Czech Republic              97971.0    77900.0
         Denmark                     62748.0    56607.0
         Egypt                      178561.0   197628.0
         Estonia                     12965.0    11365.0
         Finland                     57123.0    49042.0
         France                     364770.0   284435.0
         Germany                    454631.0   463871.0
         Ghana                       15282.0    21992.0
         Greece                     108804.0    93208.0
         Hong Kong                   42738.0    37533.0
         Hungary                     45546.0    42219.0
         Iceland                      9214.0     4746.0
         India                       45992.0   109379.0
         Indonesia                   22218.0    21347.0
         Iran                        58881.0    80111.0
         Israel                      44587.0    38836.0
         Italy                      642678.0   486488.0
         Japan                      152142.0   315702.0
         {\ldots}                             {\ldots}        {\ldots}
         Netherlands                115448.0   110429.0
         New Zealand                 70973.0    54984.0
         Nigeria                     11811.0    14436.0
         Norway                      21208.0    18194.0
         Oman                         3544.0     3544.0
         Pakistan                     9373.0    13123.0
         Poland                     133460.0    91853.0
         Portugal                    82464.0    81426.0
         Qatar                        7091.0     2492.0
         Republic of Ireland         46637.0    43479.0
         Romania                     71891.0    36487.0
         Russian Federation         100880.0   107733.0
         Saudi Arabia                20457.0    15432.0
         Serbia                      58181.0    38787.0
         Singapore                   27493.0    29127.0
         Slovakia                    16359.0    20920.0
         Slovenia                    29293.0    19528.0
         South Africa               202378.0   127820.0
         South Korea                132803.0   160881.0
         Spain                      447480.0   382851.0
         Sweden                      72958.0    59665.0
         Switzerland                 58477.0    60499.0
         Taiwan                     126448.0   170503.0
         Thailand                   111675.0    98447.0
         Turkey                     410518.0   228824.0
         Uganda                      18670.0    18670.0
         Ukraine                     17846.0    19250.0
         United Arab Emirates         9516.0     4931.0
         United Kingdom             711815.0   613028.0
         United States of America  1597414.0  1553277.0
         
         [70 rows x 2 columns]
\end{Verbatim}
            
    \hypertarget{find-the-universities-where-the-ratio-between-female-and-male-is-below-the-average-ratio-computed-over-all-universities.}{%
\subsubsection{6. Find the universities where the ratio between female
and male is below the average ratio (computed over all
universities).}\label{find-the-universities-where-the-ratio-between-female-and-male-is-below-the-average-ratio-computed-over-all-universities.}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{n}{recent\PYZus{}times}\PY{o}{.}\PY{n}{male} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:}      world\_rank         university\_name      country  teaching international  \textbackslash{}
         2227    401-500  ewha womans university  South Korea      23.9          34.3   
         
               research  citations  income total\_score  num\_students  \textbackslash{}
         2227      18.3       50.4    57.6           -       17625.0   
         
               student\_staff\_ratio international\_students female\_male\_ratio  year  \textbackslash{}
         2227                 14.4                     6\%           100 : 0  2016   
         
                female  male  
         2227  17625.0   0.0  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female\PYZus{}male\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} Empty DataFrame
         Columns: [world\_rank, university\_name, country, teaching, international, research, citations, income, total\_score, num\_students, student\_staff\_ratio, international\_students, female\_male\_ratio, year, female, male]
         Index: []
\end{Verbatim}
            
    Non ci sono valori nulli per il rapporto ma c'è un problema legato
all'università femminile \texttt{ewha\ womans\ university} che fornisce
un rapporto \(\frac{female}{male}\) pari a \(\infty\) e di conseguenza
considerare questa università nel calcolo della media porterebbe questa
a divergere. Per questo motivo la \texttt{ewha\ womans\ university}
viene esclusa e considerata a priori superiore alla media.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{recent\PYZus{}times\PYZus{}under} \PY{o}{=} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{male}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{recent\PYZus{}times\PYZus{}under}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{proper\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{female}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{/} \PY{n}{recent\PYZus{}times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{male}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{average\PYZus{}ratio} \PY{o}{=} \PY{n}{recent\PYZus{}times\PYZus{}under}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{proper\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}media geometrica}
         \PY{n}{recent\PYZus{}times\PYZus{}under} \PY{o}{=} \PY{n}{recent\PYZus{}times\PYZus{}under}\PY{p}{[}\PY{n}{recent\PYZus{}times\PYZus{}under}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{proper\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{average\PYZus{}ratio}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{average\PYZus{}ratio}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:} 1.0825701851588103
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{recent\PYZus{}times\PYZus{}under}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{proper\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}51}]:}      world\_rank                                    university\_name  \textbackslash{}
         1803          1                 california institute of technology   
         1804          2                               university of oxford   
         1805          3                                stanford university   
         1806          4                            university of cambridge   
         1807          5              massachusetts institute of technology   
         1809          7                               princeton university   
         1810          8                            imperial college london   
         1811          9  eth zurich – swiss federal institute of techno{\ldots}   
         1812         10                              university of chicago   
         1813         11                           johns hopkins university   
         1814         12                                    yale university   
         1815         13                 university of california, berkeley   
         1819         17                         university of pennsylvania   
         1820         18                                 cornell university   
         1822         20                                    duke university   
         1823         21                             university of michigan   
         1824         22                         carnegie mellon university   
         1827         25                            northwestern university   
         1828         26                   national university of singapore   
         1833         31           école polytechnique fédérale de lausanne   
         1838         36         university of illinois at urbana-champaign   
         1841         39                university of california, san diego   
         1843         41                    georgia institute of technology   
         1848         46                      university of texas at austin   
         1849         47                                tsinghua university   
         1852         50                    university of wisconsin-madison   
         1855         53                     technical university of munich   
         1856         54                           école normale supérieure   
         1857         55                   nanyang technological university   
         1867         65                     delft university of technology   
         {\ldots}         {\ldots}                                                {\ldots}   
         2547    601-800                   savitribai phule pune university   
         2548    601-800       university of science and technology beijing   
         2549    601-800                                  sejong university   
         2550    601-800                                university of seoul   
         2552    601-800                                shanghai university   
         2553    601-800                                 shantou university   
         2557    601-800                                 sichuan university   
         2559    601-800      slovak university of technology in bratislava   
         2560    601-800                                  sogang university   
         2567    601-800                           sultan qaboos university   
         2568    601-800                 suranaree university of technology   
         2571    601-800       taras shevchenko national university of kyiv   
         2572    601-800                     technical university of madrid   
         2573    601-800                               university of tehran   
         2575    601-800                              texas tech university   
         2576    601-800                                   tokai university   
         2577    601-800                               tokushima university   
         2578    601-800  tokyo university of marine science and technology   
         2579    601-800                        tokyo university of science   
         2581    601-800                                 tottori university   
         2582    601-800                 toyohashi university of technology   
         2587    601-800                            ural federal university   
         2589    601-800                                 university of vigo   
         2591    601-800                    warsaw university of technology   
         2592    601-800                                  waseda university   
         2597    601-800                                  xidian university   
         2598    601-800                                yeungnam university   
         2599    601-800                        yıldız technical university   
         2601    601-800                       yokohama national university   
         2602    601-800                                 yuan ze university   
         
               proper\_ratio  
         1803      0.492349  
         1804      0.851897  
         1805      0.724077  
         1806      0.851939  
         1807      0.587215  
         1809      0.818161  
         1810      0.587268  
         1811      0.449255  
         1812      0.724176  
         1813      1.000000  
         1814      1.000000  
         1815      1.000000  
         1819      1.040865  
         1820      0.923160  
         1822      0.960713  
         1823      0.923052  
         1824      0.639310  
         1827      0.923012  
         1828      0.960775  
         1833      0.369898  
         1838      0.886818  
         1841      0.923099  
         1843      0.449300  
         1848      1.040836  
         1849      0.470580  
         1852      1.040811  
         1855      0.492509  
         1856      0.851852  
         1857      0.923012  
         1867      0.351328  
         {\ldots}            {\ldots}  
         2547      0.333150  
         2548      0.562521  
         2549      0.754460  
         2550      0.562386  
         2552      0.923067  
         2553      0.923216  
         2557      0.923088  
         2559      0.449275  
         2560      0.754458  
         2567      1.000000  
         2568      1.000000  
         2571      0.818226  
         2572      0.470588  
         2573      0.818188  
         2575      0.851908  
         2576      0.369863  
         2577      0.515011  
         2578      0.515169  
         2579      0.250031  
         2581      0.515034  
         2582      0.099030  
         2587      0.923082  
         2589      1.040738  
         2591      0.515120  
         2592      0.538480  
         2597      0.408437  
         2598      0.923104  
         2599      0.562463  
         2601      0.388935  
         2602      0.754354  
         
         [344 rows x 3 columns]
\end{Verbatim}
            
    \hypertarget{for-each-country-compute-the-fraction-of-students-that-are-in-one-of-the-universities-computed-in-the-previous-point-that-is-the-denominator-of-the-ratio-is-the-total-number-of-students-over-all-universities-in-the-country.}{%
\subsubsection{7. For each country compute the fraction of students that
are in one of the universities computed in the previous point (that is,
the denominator of the ratio is the total number of students over all
universities in the
country).}\label{for-each-country-compute-the-fraction-of-students-that-are-in-one-of-the-universities-computed-in-the-previous-point-that-is-the-denominator-of-the-ratio-is-the-total-number-of-students-over-all-universities-in-the-country.}}

    Si creano due serie, una contenente il numero di studenti per nazione ed
una per università. Si uniscono i due sulla base della nazione in modo
da poter calcolare infine i rapporti, facendo leva sulle funzionalità di
Pandas.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{student\PYZus{}university} \PY{o}{=} \PY{n}{recent\PYZus{}times\PYZus{}under}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}students}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{student\PYZus{}university}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}52}]:} university\_name                                      country                 
         aalborg university                                   Denmark                      17422.0
         aalto university                                     Finland                      16099.0
         aberystwyth university                               United Kingdom                9252.0
         ajou university                                      South Korea                  12706.0
         alexandria university                                Egypt                       127431.0
         aligarh muslim university                            India                        11197.0
         american university of beirut                        Lebanon                       7695.0
         american university of sharjah                       United Arab Emirates          5226.0
         amirkabir university of technology                   Iran                         14080.0
         andhra university                                    India                        10407.0
         arizona state university                             United States of America     83236.0
         athens university of economics and business          Greece                       13167.0
         auburn university                                    United States of America     22386.0
         austral university of chile                          Chile                        13794.0
         bauman moscow state technical university             Russian Federation           18808.0
         bayreuth university                                  Germany                      12520.0
         ben-gurion university of the negev                   Israel                       16695.0
         binghamton university, state university of new york  United States of America     15799.0
         birla institute of technology and science, pilani    India                        11837.0
         boğaziçi university                                  Turkey                       11506.0
         brno university of technology                        Czech Republic               23694.0
         brunel university london                             United Kingdom               12613.0
         budapest university of technology and economics      Hungary                      22447.0
         cairo university                                     Egypt                       231941.0
         california institute of technology                   United States of America      2243.0
         carleton university                                  Canada                       25036.0
         carlos iii university of madrid                      Spain                        15730.0
         carnegie mellon university                           United States of America     11885.0
         case western reserve university                      United States of America      9259.0
         chalmers university of technology                    Sweden                        8605.0
                                                                                            {\ldots}   
         university of tsukuba                                Japan                        15930.0
         university of tulsa                                  United States of America      4597.0
         university of twente                                 Netherlands                   6631.0
         university of utah                                   United States of America     25674.0
         university of vigo                                   Spain                        22793.0
         university of warwick                                United Kingdom               18529.0
         university of waterloo                               Canada                       30726.0
         university of western australia                      Australia                    20851.0
         university of wisconsin-madison                      United States of America     39655.0
         university of wollongong                             Australia                    16489.0
         ural federal university                              Russian Federation           28427.0
         vienna university of technology                      Austria                      26419.0
         virginia polytechnic institute and state university  United States of America     30850.0
         všb - technical university of ostrava                Czech Republic               14991.0
         wake forest university                               United States of America      7326.0
         warsaw university of technology                      Poland                       34572.0
         waseda university                                    Japan                        52316.0
         washington state university                          United States of America     24550.0
         xidian university                                    China                        31618.0
         xi’an jiaotong university                            China                        29863.0
         yale university                                      United States of America     11751.0
         yeungnam university                                  South Korea                  21958.0
         yokohama national university                         Japan                        10117.0
         yuan ze university                                   Taiwan                        8663.0
         yıldız technical university                          Turkey                       31268.0
         zhejiang university                                  China                        47508.0
         école normale supérieure                             France                        2400.0
         école normale supérieure de lyon                     France                        2218.0
         école polytechnique                                  France                        2429.0
         école polytechnique fédérale de lausanne             Switzerland                   9666.0
         Name: num\_students, Length: 344, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{student\PYZus{}country} \PY{o}{=} \PY{n}{recent\PYZus{}times}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}students}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{student\PYZus{}merged} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(} \PY{n}{student\PYZus{}country}\PY{p}{,} \PY{n}{student\PYZus{}university}\PY{p}{,} \PY{n}{right\PYZus{}on} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{left\PYZus{}index} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{suffixes} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}university}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{p}{)}
         \PY{n}{student\PYZus{}merged}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{student\PYZus{}merged}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}54}]:}                                        university\_name  \textbackslash{}
         0                                      rmit university   
         1                   swinburne university of technology   
         2                               university of adelaide   
         3                        university of new south wales   
         4                      university of western australia   
         5                             university of wollongong   
         6                        graz university of technology   
         7                   johannes kepler university of linz   
         8                         medical university of vienna   
         9                      vienna university of technology   
         10                                 university of dhaka   
         11                         federal university of bahia   
         12             federal university of rio grande do sul   
         13                federal university of santa catarina   
         14            pontifical catholic university of paraná   
         15   pontifical catholic university of rio de janei{\ldots}   
         16   pontifical catholic university of rio grande d{\ldots}   
         17              rio de janeiro state university (uerj)   
         18                        state university of campinas   
         19                             university of são paulo   
         20                                 carleton university   
         21                                concordia university   
         22                              university of waterloo   
         23                         austral university of chile   
         24           federico santa maría technical university   
         25        pontifical catholic university of valparaíso   
         26                                 university of chile   
         27               university of santiago, chile (usach)   
         28                     dalian university of technology   
         29                                    fudan university   
         ..                                                 {\ldots}   
         314                 university of california, berkeley   
         315                university of california, riverside   
         316                university of california, san diego   
         317                              university of chicago   
         318                     university of colorado boulder   
         319                          university of connecticut   
         320                              university of houston   
         321                                university of idaho   
         322         university of illinois at urbana-champaign   
         323           university of maryland, baltimore county   
         324               university of maryland, college park   
         325                        university of massachusetts   
         326                                university of miami   
         327                             university of michigan   
         328                     university of nebraska-lincoln   
         329                           university of notre dame   
         330                         university of pennsylvania   
         331                           university of pittsburgh   
         332                            university of rochester   
         333                      university of texas at austin   
         334                      university of texas at dallas   
         335                 university of texas at san antonio   
         336                               university of toledo   
         337                                university of tulsa   
         338                                 university of utah   
         339                    university of wisconsin-madison   
         340  virginia polytechnic institute and state unive{\ldots}   
         341                             wake forest university   
         342                        washington state university   
         343                                    yale university   
         
                               country  num\_students\_country  num\_students\_university  
         0                   Australia              713376.0                  29501.0  
         1                   Australia              713376.0                  20314.0  
         2                   Australia              713376.0                  20771.0  
         3                   Australia              713376.0                  38309.0  
         4                   Australia              713376.0                  20851.0  
         5                   Australia              713376.0                  16489.0  
         6                     Austria              134477.0                   7542.0  
         7                     Austria              134477.0                  19646.0  
         8                     Austria              134477.0                   7426.0  
         9                     Austria              134477.0                  26419.0  
         10                 Bangladesh               62716.0                  62716.0  
         11                     Brazil              494251.0                  39861.0  
         12                     Brazil              494251.0                  38743.0  
         13                     Brazil              494251.0                  26078.0  
         14                     Brazil              494251.0                   7741.0  
         15                     Brazil              494251.0                  14300.0  
         16                     Brazil              494251.0                  14797.0  
         17                     Brazil              494251.0                  28757.0  
         18                     Brazil              494251.0                  27095.0  
         19                     Brazil              494251.0                  81402.0  
         20                     Canada              623629.0                  25036.0  
         21                     Canada              623629.0                  31017.0  
         22                     Canada              623629.0                  30726.0  
         23                      Chile               90951.0                  13794.0  
         24                      Chile               90951.0                  11718.0  
         25                      Chile               90951.0                  13493.0  
         26                      Chile               90951.0                  29207.0  
         27                      Chile               90951.0                  22739.0  
         28                      China              964890.0                  34326.0  
         29                      China              964890.0                  32175.0  
         ..                        {\ldots}                   {\ldots}                      {\ldots}  
         314  United States of America             3150689.0                  36186.0  
         315  United States of America             3150689.0                  20626.0  
         316  United States of America             3150689.0                  27233.0  
         317  United States of America             3150689.0                  14221.0  
         318  United States of America             3150689.0                  29325.0  
         319  United States of America             3150689.0                  25742.0  
         320  United States of America             3150689.0                  40325.0  
         321  United States of America             3150689.0                  11641.0  
         322  United States of America             3150689.0                  42727.0  
         323  United States of America             3150689.0                  13908.0  
         324  United States of America             3150689.0                  31331.0  
         325  United States of America             3150689.0                  56959.0  
         326  United States of America             3150689.0                  15286.0  
         327  United States of America             3150689.0                  41786.0  
         328  United States of America             3150689.0                  21789.0  
         329  United States of America             3150689.0                  11829.0  
         330  United States of America             3150689.0                  20376.0  
         331  United States of America             3150689.0                  26485.0  
         332  United States of America             3150689.0                   9390.0  
         333  United States of America             3150689.0                  49427.0  
         334  United States of America             3150689.0                  16306.0  
         335  United States of America             3150689.0                  27520.0  
         336  United States of America             3150689.0                  19465.0  
         337  United States of America             3150689.0                   4597.0  
         338  United States of America             3150689.0                  25674.0  
         339  United States of America             3150689.0                  39655.0  
         340  United States of America             3150689.0                  30850.0  
         341  United States of America             3150689.0                   7326.0  
         342  United States of America             3150689.0                  24550.0  
         343  United States of America             3150689.0                  11751.0  
         
         [344 rows x 4 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{student\PYZus{}merged}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{student\PYZus{}merged}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}students\PYZus{}university}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{/}\PY{n}{student\PYZus{}merged}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZus{}students\PYZus{}country}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{student\PYZus{}merged}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:}                                        university\_name  \textbackslash{}
         0                                      rmit university   
         1                   swinburne university of technology   
         2                               university of adelaide   
         3                        university of new south wales   
         4                      university of western australia   
         5                             university of wollongong   
         6                        graz university of technology   
         7                   johannes kepler university of linz   
         8                         medical university of vienna   
         9                      vienna university of technology   
         10                                 university of dhaka   
         11                         federal university of bahia   
         12             federal university of rio grande do sul   
         13                federal university of santa catarina   
         14            pontifical catholic university of paraná   
         15   pontifical catholic university of rio de janei{\ldots}   
         16   pontifical catholic university of rio grande d{\ldots}   
         17              rio de janeiro state university (uerj)   
         18                        state university of campinas   
         19                             university of são paulo   
         20                                 carleton university   
         21                                concordia university   
         22                              university of waterloo   
         23                         austral university of chile   
         24           federico santa maría technical university   
         25        pontifical catholic university of valparaíso   
         26                                 university of chile   
         27               university of santiago, chile (usach)   
         28                     dalian university of technology   
         29                                    fudan university   
         ..                                                 {\ldots}   
         314                 university of california, berkeley   
         315                university of california, riverside   
         316                university of california, san diego   
         317                              university of chicago   
         318                     university of colorado boulder   
         319                          university of connecticut   
         320                              university of houston   
         321                                university of idaho   
         322         university of illinois at urbana-champaign   
         323           university of maryland, baltimore county   
         324               university of maryland, college park   
         325                        university of massachusetts   
         326                                university of miami   
         327                             university of michigan   
         328                     university of nebraska-lincoln   
         329                           university of notre dame   
         330                         university of pennsylvania   
         331                           university of pittsburgh   
         332                            university of rochester   
         333                      university of texas at austin   
         334                      university of texas at dallas   
         335                 university of texas at san antonio   
         336                               university of toledo   
         337                                university of tulsa   
         338                                 university of utah   
         339                    university of wisconsin-madison   
         340  virginia polytechnic institute and state unive{\ldots}   
         341                             wake forest university   
         342                        washington state university   
         343                                    yale university   
         
                               country  num\_students\_country  num\_students\_university  \textbackslash{}
         0                   Australia              713376.0                  29501.0   
         1                   Australia              713376.0                  20314.0   
         2                   Australia              713376.0                  20771.0   
         3                   Australia              713376.0                  38309.0   
         4                   Australia              713376.0                  20851.0   
         5                   Australia              713376.0                  16489.0   
         6                     Austria              134477.0                   7542.0   
         7                     Austria              134477.0                  19646.0   
         8                     Austria              134477.0                   7426.0   
         9                     Austria              134477.0                  26419.0   
         10                 Bangladesh               62716.0                  62716.0   
         11                     Brazil              494251.0                  39861.0   
         12                     Brazil              494251.0                  38743.0   
         13                     Brazil              494251.0                  26078.0   
         14                     Brazil              494251.0                   7741.0   
         15                     Brazil              494251.0                  14300.0   
         16                     Brazil              494251.0                  14797.0   
         17                     Brazil              494251.0                  28757.0   
         18                     Brazil              494251.0                  27095.0   
         19                     Brazil              494251.0                  81402.0   
         20                     Canada              623629.0                  25036.0   
         21                     Canada              623629.0                  31017.0   
         22                     Canada              623629.0                  30726.0   
         23                      Chile               90951.0                  13794.0   
         24                      Chile               90951.0                  11718.0   
         25                      Chile               90951.0                  13493.0   
         26                      Chile               90951.0                  29207.0   
         27                      Chile               90951.0                  22739.0   
         28                      China              964890.0                  34326.0   
         29                      China              964890.0                  32175.0   
         ..                        {\ldots}                   {\ldots}                      {\ldots}   
         314  United States of America             3150689.0                  36186.0   
         315  United States of America             3150689.0                  20626.0   
         316  United States of America             3150689.0                  27233.0   
         317  United States of America             3150689.0                  14221.0   
         318  United States of America             3150689.0                  29325.0   
         319  United States of America             3150689.0                  25742.0   
         320  United States of America             3150689.0                  40325.0   
         321  United States of America             3150689.0                  11641.0   
         322  United States of America             3150689.0                  42727.0   
         323  United States of America             3150689.0                  13908.0   
         324  United States of America             3150689.0                  31331.0   
         325  United States of America             3150689.0                  56959.0   
         326  United States of America             3150689.0                  15286.0   
         327  United States of America             3150689.0                  41786.0   
         328  United States of America             3150689.0                  21789.0   
         329  United States of America             3150689.0                  11829.0   
         330  United States of America             3150689.0                  20376.0   
         331  United States of America             3150689.0                  26485.0   
         332  United States of America             3150689.0                   9390.0   
         333  United States of America             3150689.0                  49427.0   
         334  United States of America             3150689.0                  16306.0   
         335  United States of America             3150689.0                  27520.0   
         336  United States of America             3150689.0                  19465.0   
         337  United States of America             3150689.0                   4597.0   
         338  United States of America             3150689.0                  25674.0   
         339  United States of America             3150689.0                  39655.0   
         340  United States of America             3150689.0                  30850.0   
         341  United States of America             3150689.0                   7326.0   
         342  United States of America             3150689.0                  24550.0   
         343  United States of America             3150689.0                  11751.0   
         
                 ratio  
         0    0.041354  
         1    0.028476  
         2    0.029116  
         3    0.053701  
         4    0.029229  
         5    0.023114  
         6    0.056084  
         7    0.146092  
         8    0.055221  
         9    0.196457  
         10   1.000000  
         11   0.080649  
         12   0.078387  
         13   0.052763  
         14   0.015662  
         15   0.028933  
         16   0.029938  
         17   0.058183  
         18   0.054820  
         19   0.164698  
         20   0.040146  
         21   0.049736  
         22   0.049270  
         23   0.151664  
         24   0.128839  
         25   0.148355  
         26   0.321129  
         27   0.250014  
         28   0.035575  
         29   0.033346  
         ..        {\ldots}  
         314  0.011485  
         315  0.006547  
         316  0.008644  
         317  0.004514  
         318  0.009307  
         319  0.008170  
         320  0.012799  
         321  0.003695  
         322  0.013561  
         323  0.004414  
         324  0.009944  
         325  0.018078  
         326  0.004852  
         327  0.013262  
         328  0.006916  
         329  0.003754  
         330  0.006467  
         331  0.008406  
         332  0.002980  
         333  0.015688  
         334  0.005175  
         335  0.008735  
         336  0.006178  
         337  0.001459  
         338  0.008149  
         339  0.012586  
         340  0.009792  
         341  0.002325  
         342  0.007792  
         343  0.003730  
         
         [344 rows x 5 columns]
\end{Verbatim}
            
    \hypertarget{read-the-file-educational_attainment_supplementary_data.csv-discarding-any-row-without-country_name-or-series_name.}{%
\subsubsection{8. Read the file
educational\_attainment\_supplementary\_data.csv, discarding any row
without country\_name or
series\_name.}\label{read-the-file-educational_attainment_supplementary_data.csv-discarding-any-row-without-country_name-or-series_name.}}

    Per questa richiesta abbiamo usato il metodo \texttt{dropna} con flag
\texttt{subset} per eliminare le righe con \texttt{null} nelle due
colonne indicate. Si verifica la riduzione del numero di righe con il
metodo \texttt{shape}.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://github.com/DanieleRizz0/CSProject/blob/main/educational\PYZus{}attainment\PYZus{}supplementary\PYZus{}data.csv?raw=true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}57}]:} (79055, 29)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{series\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:}       country\_name                                        series\_name  1985  \textbackslash{}
         0      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.33   
         1      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1.03   
         2      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.83   
         3      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2.34   
         4      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.54   
         5      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1.52   
         6      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.17   
         7      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.66   
         8      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.44   
         9      Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1.28   
         10     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.22   
         11     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.95   
         12     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.22   
         13     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.95   
         14     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.06   
         15     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.36   
         16     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.06   
         17     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.36   
         18     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.02   
         19     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.24   
         20     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.02   
         21     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.24   
         22     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.01   
         23     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.14   
         24     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.01   
         25     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.14   
         26     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.01   
         27     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.06   
         28     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.01   
         29     Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.06   
         {\ldots}            {\ldots}                                                {\ldots}   {\ldots}   
         79020     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79021     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79022     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79023     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79024     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79025     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79026     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79027     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79028     Zimbabwe  UIS: Percentage of population age 25+ with at {\ldots}   NaN   
         79029     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79030     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79031     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79032     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79033     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79034     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79035     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79036     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79037     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79038     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79039     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79040     Zimbabwe  UIS: Percentage of population age 25+ with com{\ldots}   NaN   
         79041     Zimbabwe  UIS: Percentage of population age 25+ with no {\ldots}   NaN   
         79042     Zimbabwe  UIS: Percentage of population age 25+ with no {\ldots}   NaN   
         79043     Zimbabwe  UIS: Percentage of population age 25+ with no {\ldots}   NaN   
         79044     Zimbabwe  UIS: Percentage of population age 25+ with som{\ldots}   NaN   
         79045     Zimbabwe  UIS: Percentage of population age 25+ with som{\ldots}   NaN   
         79046     Zimbabwe  UIS: Percentage of population age 25+ with som{\ldots}   NaN   
         79047     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}   NaN   
         79048     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}   NaN   
         79049     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}   NaN   
         
                1986  1987  1990  1991  1992  1993  1995  {\ldots}  2005  2006  2007  2008  \textbackslash{}
         0       NaN   NaN  0.44   NaN   NaN   NaN  0.57  {\ldots}  0.86   NaN   NaN   NaN   
         1       NaN   NaN  1.26   NaN   NaN   NaN  1.54  {\ldots}  2.18   NaN   NaN   NaN   
         2       NaN   NaN  0.95   NaN   NaN   NaN  1.26  {\ldots}  1.01   NaN   NaN   NaN   
         3       NaN   NaN  2.22   NaN   NaN   NaN  2.37  {\ldots}  2.26   NaN   NaN   NaN   
         4       NaN   NaN  0.92   NaN   NaN   NaN  0.94  {\ldots}  2.00   NaN   NaN   NaN   
         5       NaN   NaN  2.51   NaN   NaN   NaN  2.27  {\ldots}  3.93   NaN   NaN   NaN   
         6       NaN   NaN  0.25   NaN   NaN   NaN  0.37  {\ldots}  0.63   NaN   NaN   NaN   
         7       NaN   NaN  0.85   NaN   NaN   NaN  1.14  {\ldots}  1.69   NaN   NaN   NaN   
         8       NaN   NaN  0.54   NaN   NaN   NaN  0.92  {\ldots}  1.26   NaN   NaN   NaN   
         9       NaN   NaN  1.52   NaN   NaN   NaN  2.51  {\ldots}  2.48   NaN   NaN   NaN   
         10      NaN   NaN  0.44   NaN   NaN   NaN  0.54  {\ldots}  0.94   NaN   NaN   NaN   
         11      NaN   NaN  1.28   NaN   NaN   NaN  1.52  {\ldots}  2.27   NaN   NaN   NaN   
         12      NaN   NaN  0.22   NaN   NaN   NaN  0.44  {\ldots}  0.92   NaN   NaN   NaN   
         13      NaN   NaN  0.95   NaN   NaN   NaN  1.28  {\ldots}  2.51   NaN   NaN   NaN   
         14      NaN   NaN  0.22   NaN   NaN   NaN  0.22  {\ldots}  0.54   NaN   NaN   NaN   
         15      NaN   NaN  0.95   NaN   NaN   NaN  0.95  {\ldots}  1.52   NaN   NaN   NaN   
         16      NaN   NaN  0.06   NaN   NaN   NaN  0.22  {\ldots}  0.44   NaN   NaN   NaN   
         17      NaN   NaN  0.36   NaN   NaN   NaN  0.95  {\ldots}  1.28   NaN   NaN   NaN   
         18      NaN   NaN  0.06   NaN   NaN   NaN  0.06  {\ldots}  0.22   NaN   NaN   NaN   
         19      NaN   NaN  0.36   NaN   NaN   NaN  0.36  {\ldots}  0.95   NaN   NaN   NaN   
         20      NaN   NaN  0.02   NaN   NaN   NaN  0.06  {\ldots}  0.22   NaN   NaN   NaN   
         21      NaN   NaN  0.24   NaN   NaN   NaN  0.36  {\ldots}  0.95   NaN   NaN   NaN   
         22      NaN   NaN  0.02   NaN   NaN   NaN  0.02  {\ldots}  0.06   NaN   NaN   NaN   
         23      NaN   NaN  0.24   NaN   NaN   NaN  0.24  {\ldots}  0.36   NaN   NaN   NaN   
         24      NaN   NaN  0.01   NaN   NaN   NaN  0.02  {\ldots}  0.06   NaN   NaN   NaN   
         25      NaN   NaN  0.14   NaN   NaN   NaN  0.24  {\ldots}  0.36   NaN   NaN   NaN   
         26      NaN   NaN  0.02   NaN   NaN   NaN  0.02  {\ldots}  0.03   NaN   NaN   NaN   
         27      NaN   NaN  0.15   NaN   NaN   NaN  0.15  {\ldots}  0.25   NaN   NaN   NaN   
         28      NaN   NaN  0.01   NaN   NaN   NaN  0.01  {\ldots}  0.02   NaN   NaN   NaN   
         29      NaN   NaN  0.06   NaN   NaN   NaN  0.11  {\ldots}  0.21   NaN   NaN   NaN   
         {\ldots}     {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}  {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   
         79020   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79021   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79022   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79023   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79024   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79025   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79026   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79027   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79028   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79029   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79030   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79031   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79032   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79033   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79034   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79035   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79036   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79037   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79038   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79039   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79040   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79041   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79042   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79043   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79044   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79045   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79046   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79047   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79048   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         79049   NaN   NaN   NaN   NaN   NaN   NaN   NaN  {\ldots}   NaN   NaN   NaN   NaN   
         
                2009  2010  2011      2012  2013  2015  
         0       NaN  1.27   NaN       NaN   NaN   NaN  
         1       NaN  2.64   NaN       NaN   NaN   NaN  
         2       NaN  2.45   NaN       NaN   NaN   NaN  
         3       NaN  3.55   NaN       NaN   NaN   NaN  
         4       NaN  1.29   NaN       NaN   NaN   NaN  
         5       NaN  2.64   NaN       NaN   NaN   NaN  
         6       NaN  0.81   NaN       NaN   NaN   NaN  
         7       NaN  2.19   NaN       NaN   NaN   NaN  
         8       NaN  1.92   NaN       NaN   NaN   NaN  
         9       NaN  3.93   NaN       NaN   NaN   NaN  
         10      NaN  1.26   NaN       NaN   NaN   NaN  
         11      NaN  2.48   NaN       NaN   NaN   NaN  
         12      NaN  0.94   NaN       NaN   NaN   NaN  
         13      NaN  2.27   NaN       NaN   NaN   NaN  
         14      NaN  0.92   NaN       NaN   NaN   NaN  
         15      NaN  2.51   NaN       NaN   NaN   NaN  
         16      NaN  0.54   NaN       NaN   NaN   NaN  
         17      NaN  1.52   NaN       NaN   NaN   NaN  
         18      NaN  0.44   NaN       NaN   NaN   NaN  
         19      NaN  1.28   NaN       NaN   NaN   NaN  
         20      NaN  0.22   NaN       NaN   NaN   NaN  
         21      NaN  0.95   NaN       NaN   NaN   NaN  
         22      NaN  0.22   NaN       NaN   NaN   NaN  
         23      NaN  0.95   NaN       NaN   NaN   NaN  
         24      NaN  0.06   NaN       NaN   NaN   NaN  
         25      NaN  0.36   NaN       NaN   NaN   NaN  
         26      NaN  0.06   NaN       NaN   NaN   NaN  
         27      NaN  0.37   NaN       NaN   NaN   NaN  
         28      NaN  0.03   NaN       NaN   NaN   NaN  
         29      NaN  0.24   NaN       NaN   NaN   NaN  
         {\ldots}     {\ldots}   {\ldots}   {\ldots}       {\ldots}   {\ldots}   {\ldots}  
         79020   NaN   NaN   NaN       NaN   NaN   NaN  
         79021   NaN   NaN   NaN  68.00913   NaN   NaN  
         79022   NaN   NaN   NaN   0.85056   NaN   NaN  
         79023   NaN   NaN   NaN  79.95794   NaN   NaN  
         79024   NaN   NaN   NaN  73.47838   NaN   NaN  
         79025   NaN   NaN   NaN   3.46645   NaN   NaN  
         79026   NaN   NaN   NaN   0.43507   NaN   NaN  
         79027   NaN   NaN   NaN   7.96755   NaN   NaN  
         79028   NaN   NaN   NaN   5.52671   NaN   NaN  
         79029   NaN   NaN   NaN  45.18606   NaN   NaN  
         79030   NaN   NaN   NaN  54.99416   NaN   NaN  
         79031   NaN   NaN   NaN  49.67546   NaN   NaN  
         79032   NaN   NaN   NaN       NaN   NaN   NaN  
         79033   NaN   NaN   NaN       NaN   NaN   NaN  
         79034   NaN   NaN   NaN       NaN   NaN   NaN  
         79035   NaN   NaN   NaN  19.35662   NaN   NaN  
         79036   NaN   NaN   NaN  16.99624   NaN   NaN  
         79037   NaN   NaN   NaN  18.27621   NaN   NaN  
         79038   NaN   NaN   NaN   1.35334   NaN   NaN  
         79039   NaN   NaN   NaN   3.72285   NaN   NaN  
         79040   NaN   NaN   NaN   2.43792   NaN   NaN  
         79041   NaN   NaN   NaN   0.91324   NaN   NaN  
         79042   NaN   NaN   NaN   0.42733   NaN   NaN  
         79043   NaN   NaN   NaN   0.69083   NaN   NaN  
         79044   NaN   NaN   NaN  19.08351   NaN   NaN  
         79045   NaN   NaN   NaN  13.84323   NaN   NaN  
         79046   NaN   NaN   NaN  16.68491   NaN   NaN  
         79047   NaN   NaN   NaN  11.99412   NaN   NaN  
         79048   NaN   NaN   NaN   5.77150   NaN   NaN  
         79049   NaN   NaN   NaN   9.14588   NaN   NaN  
         
         [79050 rows x 29 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}59}]:} (79050, 29)
\end{Verbatim}
            
    \hypertarget{from-attainment-build-a-dataframe-with-the-same-data-but-with-4-columns-country_name-series_name-year-value.}{%
\subsubsection{9. From attainment build a dataframe with the same data,
but with 4 columns: country\_name, series\_name, year,
value.}\label{from-attainment-build-a-dataframe-with-the-same-data-but-with-4-columns-country_name-series_name-year-value.}}

    Per risolvere il quesito si utilizzato il metodo di Pandas
\texttt{stack}, che consente di trasporre le colonne del dataframe
rappresentative degli anni, passando così da un dataset di tipo key
figure-based ad uno account-based. Per non perdere i valori nulli nel
calcolo, viene settato il flag \texttt{dropna} del metodo su
\texttt{False}.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}60}]:}   country\_name                                        series\_name  1985  1986  \textbackslash{}
         0  Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  0.33   NaN   
         
            1987  1990  1991  1992  1993  1995  {\ldots}  2005  2006  2007  2008  2009  \textbackslash{}
         0   NaN  0.44   NaN   NaN   NaN  0.57  {\ldots}  0.86   NaN   NaN   NaN   NaN   
         
            2010  2011  2012  2013  2015  
         0  1.27   NaN   NaN   NaN   NaN  
         
         [1 rows x 29 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{four\PYZus{}columns\PYZus{}att} \PY{o}{=} \PY{n}{edu\PYZus{}att\PYZus{}supp\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{country\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{series\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{four\PYZus{}columns\PYZus{}att} \PY{o}{=} \PY{n}{four\PYZus{}columns\PYZus{}att}\PY{o}{.}\PY{n}{stack}\PY{p}{(}\PY{n}{dropna} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{four\PYZus{}columns\PYZus{}att}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{level\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{four\PYZus{}columns\PYZus{}att}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:}         country\_name                                        series\_name  year  \textbackslash{}
         0        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1985   
         1        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1986   
         2        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1987   
         3        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1990   
         4        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1991   
         5        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1992   
         6        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1993   
         7        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1995   
         8        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1996   
         9        Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1997   
         10       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1998   
         11       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1999   
         12       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2000   
         13       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2001   
         14       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2002   
         15       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2003   
         16       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2004   
         17       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2005   
         18       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2006   
         19       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2007   
         20       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2008   
         21       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2009   
         22       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2010   
         23       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2011   
         24       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2012   
         25       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2013   
         26       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  2015   
         27       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1985   
         28       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1986   
         29       Afghanistan  Barro-Lee: Average years of primary schooling,{\ldots}  1987   
         {\ldots}              {\ldots}                                                {\ldots}   {\ldots}   
         2134320     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2012   
         2134321     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2013   
         2134322     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2015   
         2134323     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1985   
         2134324     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1986   
         2134325     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1987   
         2134326     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1990   
         2134327     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1991   
         2134328     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1992   
         2134329     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1993   
         2134330     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1995   
         2134331     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1996   
         2134332     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1997   
         2134333     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1998   
         2134334     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  1999   
         2134335     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2000   
         2134336     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2001   
         2134337     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2002   
         2134338     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2003   
         2134339     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2004   
         2134340     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2005   
         2134341     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2006   
         2134342     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2007   
         2134343     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2008   
         2134344     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2009   
         2134345     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2010   
         2134346     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2011   
         2134347     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2012   
         2134348     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2013   
         2134349     Zimbabwe  UIS: Percentage of population age 25+ with unk{\ldots}  2015   
         
                    value  
         0        0.33000  
         1            NaN  
         2            NaN  
         3        0.44000  
         4            NaN  
         5            NaN  
         6            NaN  
         7        0.57000  
         8            NaN  
         9            NaN  
         10           NaN  
         11           NaN  
         12       0.75000  
         13           NaN  
         14           NaN  
         15           NaN  
         16           NaN  
         17       0.86000  
         18           NaN  
         19           NaN  
         20           NaN  
         21           NaN  
         22       1.27000  
         23           NaN  
         24           NaN  
         25           NaN  
         26           NaN  
         27       1.03000  
         28           NaN  
         29           NaN  
         {\ldots}          {\ldots}  
         2134320  5.77150  
         2134321      NaN  
         2134322      NaN  
         2134323      NaN  
         2134324      NaN  
         2134325      NaN  
         2134326      NaN  
         2134327      NaN  
         2134328      NaN  
         2134329      NaN  
         2134330      NaN  
         2134331      NaN  
         2134332      NaN  
         2134333      NaN  
         2134334      NaN  
         2134335      NaN  
         2134336      NaN  
         2134337      NaN  
         2134338      NaN  
         2134339      NaN  
         2134340      NaN  
         2134341      NaN  
         2134342      NaN  
         2134343      NaN  
         2134344      NaN  
         2134345      NaN  
         2134346      NaN  
         2134347  9.14588  
         2134348      NaN  
         2134349      NaN  
         
         [2134350 rows x 4 columns]
\end{Verbatim}
            
    \hypertarget{for-each-university-find-the-number-of-rankings-in-which-they-appear-it-suffices-to-appear-in-one-year-for-each-ranking.}{%
\subsubsection{10. For each university, find the number of rankings in
which they appear (it suffices to appear in one year for each
ranking).}\label{for-each-university-find-the-number-of-rankings-in-which-they-appear-it-suffices-to-appear-in-one-year-for-each-ranking.}}

    Per questa richiesta si sfruttano le operazioni di insieme. Si
inseriscono le università presenti nei diversi ranking in altrettanti
set. Infine si uniscono e si effettua un conteggio per il numero di
volte che un'università si trova all'interno dell'insieme complessivo.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{n}{uni\PYZus{}times} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{times}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{uni\PYZus{}shangai} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{shangai}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{uni\PYZus{}cwur} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{cwur}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{institution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{universities} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{uni\PYZus{}times}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{uni\PYZus{}shangai}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{uni\PYZus{}cwur}\PY{p}{)}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{universities}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:} university
         aalborg university                                    3
         aalto university                                      3
         aarhus university                                     3
         aberystwyth university                                2
         adam mickiewicz university                            1
         adam mickiewicz university in poznań                  1
         agh university of science and technology              2
         ain shams university                                  1
         aix marseille university                              1
         aix-marseille university                              3
         ajou university                                       2
         albany medical college                                1
         albert ludwig university of freiburg                  1
         alexandria university                                 2
         alexandru ioan cuza university                        1
         aligarh muslim university                             1
         all india institute of medical sciences, new delhi    1
         american university                                   1
         american university of beirut                         2
         american university of sharjah                        1
         amirkabir university of technology                    2
         amrita university                                     1
         anadolu university                                    1
         andhra university                                     1
         ankara university                                     1
         aristotle university of thessaloniki                  3
         arizona state university                              3
         arizona state university - tempe                      1
         asia university, taiwan                               1
         aston university                                      2
                                                              ..
         xidian university                                     2
         xi’an jiaotong university                             1
         yale university                                       3
         yamagata university                                   1
         yamaguchi university                                  2
         yanbian university                                    1
         yangzhou university                                   1
         yeshiva university                                    3
         yeungnam university                                   2
         yokohama city university                              2
         yokohama national university                          2
         yonsei university                                     3
         york university                                       3
         yuan ze university                                    2
         yıldız technical university                           1
         zhejiang normal university                            1
         zhejiang university                                   3
         zhejiang university of technology                     1
         zhengzhou university                                  1
         åbo akademi university                                1
         école centrale de lyon                                1
         école centrale paris                                  1
         école normale supérieure                              1
         école normale supérieure - paris                      1
         école normale supérieure de cachan                    1
         école normale supérieure de lyon                      2
         école polytechnique                                   2
         école polytechnique de montréal                       1
         école polytechnique fédérale de lausanne              1
         örebro university                                     2
         Length: 1445, dtype: int64
\end{Verbatim}
            
    \hypertarget{in-the-times-ranking-compute-the-number-of-times-each-university-appears.}{%
\subsubsection{11. In the times ranking, compute the number of times
each university
appears.}\label{in-the-times-ranking-compute-the-number-of-times-each-university-appears.}}

    Per questo punto si raggruppa il dataframe in base all'università
utilizzando la funzione \texttt{groupby} di Pandas e si effettua un
conteggio.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{times}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:} university\_name
         aalborg university                             5
         aalto university                               5
         aarhus university                              6
         aberystwyth university                         5
         adam mickiewicz university                     1
         agh university of science and technology       1
         aix-marseille university                       1
         ajou university                                1
         alexandria university                          3
         alexandru ioan cuza university                 1
         aligarh muslim university                      1
         american university                            1
         american university of beirut                  1
         american university of sharjah                 1
         amirkabir university of technology             1
         amrita university                              1
         anadolu university                             1
         andhra university                              1
         aristotle university of thessaloniki           1
         arizona state university                       6
         asia university, taiwan                        1
         aston university                               3
         athens university of economics and business    1
         auburn university                              2
         auckland university of technology              1
         austral university of chile                    1
         australian national university                 6
         autonomous university of barcelona             5
         autonomous university of madrid                5
         babeş-bolyai university                        1
                                                       ..
         wageningen university and research center      6
         wake forest university                         6
         warsaw university of technology                1
         waseda university                              4
         washington state university                    5
         washington university in st louis              6
         wayne state university                         5
         west university of timişoara                   1
         western sydney university                      2
         william \& mary                                 6
         wuhan university                               3
         wuhan university of technology                 2
         xiamen university                              1
         xidian university                              1
         xi’an jiaotong university                      1
         yale university                                6
         yeshiva university                             6
         yeungnam university                            1
         yokohama city university                       1
         yokohama national university                   1
         yonsei university                              6
         york university                                5
         yuan ze university                             2
         yıldız technical university                    1
         zhejiang university                            6
         école normale supérieure                       6
         école normale supérieure de lyon               6
         école polytechnique                            6
         école polytechnique fédérale de lausanne       6
         örebro university                              1
         Length: 818, dtype: int64
\end{Verbatim}
            
    \hypertarget{find-the-universities-that-appear-at-most-twice-in-the-times-ranking.}{%
\subsubsection{12. Find the universities that appear at most twice in
the times
ranking.}\label{find-the-universities-that-appear-at-most-twice-in-the-times-ranking.}}

    Si definisce una maschera booleana tale da ritornare \texttt{True} se le
università sono presenti al più due volte nel ranking \texttt{times}.
Infine si sfrutta questa maschera per estrarre le università
corrispondenti.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{tf} \PY{o}{=} \PY{n}{times}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{tf}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}66}]:} university\_name
         aalborg university                             False
         aalto university                               False
         aarhus university                              False
         aberystwyth university                         False
         adam mickiewicz university                      True
         agh university of science and technology        True
         aix-marseille university                        True
         ajou university                                 True
         alexandria university                          False
         alexandru ioan cuza university                  True
         aligarh muslim university                       True
         american university                             True
         american university of beirut                   True
         american university of sharjah                  True
         amirkabir university of technology              True
         amrita university                               True
         anadolu university                              True
         andhra university                               True
         aristotle university of thessaloniki            True
         arizona state university                       False
         asia university, taiwan                         True
         aston university                               False
         athens university of economics and business     True
         auburn university                               True
         auckland university of technology               True
         austral university of chile                     True
         australian national university                 False
         autonomous university of barcelona             False
         autonomous university of madrid                False
         babeş-bolyai university                         True
                                                        {\ldots}  
         wageningen university and research center      False
         wake forest university                         False
         warsaw university of technology                 True
         waseda university                              False
         washington state university                    False
         washington university in st louis              False
         wayne state university                         False
         west university of timişoara                    True
         western sydney university                       True
         william \& mary                                 False
         wuhan university                               False
         wuhan university of technology                  True
         xiamen university                               True
         xidian university                               True
         xi’an jiaotong university                       True
         yale university                                False
         yeshiva university                             False
         yeungnam university                             True
         yokohama city university                        True
         yokohama national university                    True
         yonsei university                              False
         york university                                False
         yuan ze university                              True
         yıldız technical university                     True
         zhejiang university                            False
         école normale supérieure                       False
         école normale supérieure de lyon               False
         école polytechnique                            False
         école polytechnique fédérale de lausanne       False
         örebro university                               True
         Length: 818, dtype: bool
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{n+nb}{set}\PY{p}{(}\PY{n}{tf}\PY{p}{[}\PY{n}{tf} \PY{o}{==} \PY{k+kc}{True}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}67}]:} \{'adam mickiewicz university',
          'agh university of science and technology',
          'aix-marseille university',
          'ajou university',
          'alexandru ioan cuza university',
          'aligarh muslim university',
          'american university',
          'american university of beirut',
          'american university of sharjah',
          'amirkabir university of technology',
          'amrita university',
          'anadolu university',
          'andhra university',
          'aristotle university of thessaloniki',
          'asia university, taiwan',
          'athens university of economics and business',
          'auburn university',
          'auckland university of technology',
          'austral university of chile',
          'babeş-bolyai university',
          'bar-ilan university',
          'bauman moscow state technical university',
          'beijing institute of technology',
          'belarusian state university',
          'ben-gurion university of the negev',
          'birla institute of technology and science, pilani',
          'blaise pascal university',
          'bournemouth university',
          'brno university of technology',
          'budapest university of technology and economics',
          'cairo university',
          'california state university, long beach',
          'capital medical university',
          'carlos iii university of madrid',
          'catholic university of the sacred heart',
          'ca’ foscari university of venice',
          'central queensland university',
          'chang gung university',
          'charité - universitätsmedizin berlin',
          'chiang mai university',
          'chiba university',
          'china agricultural university',
          'china medical university, taiwan',
          'china university of geosciences (wuhan)',
          'china university of petroleum (beijing)',
          'chonbuk national university',
          'chongqing university',
          'chonnam national university',
          'chulalongkorn university',
          'chung yuan christian university',
          'chung-ang university',
          'chungnam national university',
          'city university london',
          'clemson university',
          'comenius university in bratislava',
          'complutense university of madrid',
          'concordia university',
          'copenhagen business school',
          'coventry university',
          'czech technical university in prague',
          'dalian university of technology',
          'de montfort university',
          'dublin city university',
          'dublin institute of technology',
          'east china normal university',
          'east china university of science and technology',
          'edith cowan university',
          'ehime university',
          'erciyes university',
          'ewha womans university',
          'eötvös loránd university',
          'federal university of bahia',
          'federal university of lavras',
          'federal university of minas gerais',
          'federal university of paraná (ufpr)',
          'federal university of rio de janeiro',
          'federal university of rio grande do sul',
          'federal university of santa catarina',
          'federal university of são carlos',
          'federal university of viçosa',
          'federico santa maría technical university',
          'feng chia university',
          'florida international university',
          'florida state university',
          'fu jen catholic university',
          'gdańsk university of technology',
          'georgia state university',
          'gifu university',
          'glasgow caledonian university',
          'graz university of technology',
          'griffith university',
          'gwangju institute of science and technology',
          'hacettepe university',
          'harbin institute of technology',
          'hiroshima university',
          'howard university',
          'huazhong university of science and technology',
          'hunan university',
          'i-shou university',
          'illinois institute of technology',
          'indian institute of science',
          'indian institute of technology delhi',
          'indian institute of technology guwahati',
          'indian institute of technology kanpur',
          'indian institute of technology madras',
          'inha university',
          'instituto superior técnico lisboa',
          'iran university of science and technology',
          'isfahan university of technology',
          'istanbul university',
          'jadavpur university',
          'james cook university',
          'jilin university',
          'johannes gutenberg university of mainz',
          'jordan university of science and technology',
          'juntendo university',
          'justus liebig university giessen',
          'k.n. toosi university of technology',
          'kanazawa university',
          'kaohsiung medical university',
          'kazan federal university',
          'khon kaen university',
          'king fahd university of petroleum and minerals',
          'king saud university',
          'kingston university',
          'kinki university',
          'kobe university',
          'konkuk university',
          'kumamoto university',
          'kyung hee university',
          'kyungpook national university',
          'kyushu institute of technology',
          'la trobe university',
          'lappeenranta university of technology',
          'lille 1 university – science and technology',
          'lille 2 university – health and law',
          'louisiana state university',
          'mahidol university',
          'makerere university',
          'manchester metropolitan university',
          'marche polytechnic university',
          'masaryk university',
          'medical college of wisconsin',
          'medical university of south carolina',
          'memorial university of newfoundland',
          'miami university',
          'michigan technological university',
          'middlesex university',
          'missouri university of science and technology',
          'montana state university',
          'monterrey institute of technology and higher education',
          'moscow institute of physics and technology',
          'nagasaki university',
          'national and kapodistrian university of athens',
          'national autonomous university of mexico',
          'national chengchi university',
          'national chung cheng university',
          'national chung hsing university',
          'national institute of applied sciences of lyon (insa lyon)',
          'national research nuclear university mephi',
          'national taipei university of technology',
          'national taiwan normal university',
          'national taiwan ocean university',
          'national technical university of athens',
          'national university of córdoba',
          'national university of science and technology (misis)',
          'national university of sciences and technology',
          'national yang-ming university',
          'new jersey institute of technology',
          'new mexico state university',
          'new university of lisbon',
          'niigata university',
          'north carolina state university',
          'northumbria university',
          'northwestern polytechnical university',
          'nottingham trent university',
          'novosibirsk state university',
          'oakland university',
          'ocean university of china',
          'ohio university',
          'okayama university',
          'oklahoma state university',
          'old dominion university',
          'oregon health and science university',
          'osaka city university',
          'osaka prefecture university',
          'otto von guericke university of magdeburg',
          'oxford brookes university',
          'palacký university in olomouc',
          'panthéon-sorbonne university – paris 1',
          'paris dauphine university',
          'paris descartes university',
          'paris-sorbonne university – paris 4',
          'peter the great st petersburg polytechnic university',
          'polytechnic university of catalonia',
          'polytechnic university of turin',
          'pontifical catholic university of chile',
          'pontifical catholic university of paraná',
          'pontifical catholic university of rio de janeiro (puc-rio)',
          'pontifical catholic university of rio grande do sul (pucrs)',
          'pontifical catholic university of valparaíso',
          'portland state university',
          'prince of songkla university',
          'pusan national university',
          'qatar university',
          'quaid-i-azam university',
          'rio de janeiro state university (uerj)',
          'rmit university',
          'rochester institute of technology',
          'royal college of surgeons in ireland',
          'royal veterinary college',
          'rush university',
          'sabancı university',
          'saint louis university',
          'saint petersburg state university',
          'saitama university',
          'savitribai phule pune university',
          'scuola normale superiore di pisa',
          'scuola superiore sant’anna',
          'sejong university',
          'semmelweis university',
          'shahid beheshti university',
          'shanghai university',
          'shantou university',
          'sheffield hallam university',
          'shinshu university',
          'showa university',
          'sichuan university',
          'slovak university of technology in bratislava',
          'sogang university',
          'soochow university',
          'sophia university',
          'south china university of technology',
          'southern cross university',
          'southern federal university',
          'southern methodist university',
          'suez canal university',
          'sultan qaboos university',
          'suranaree university of technology',
          'swansea university',
          'syracuse university',
          'são paulo state university (unesp)',
          'taipei medical university',
          'tallinn university of technology',
          'tampere university of technology',
          'taras shevchenko national university of kyiv',
          'technical university of berlin',
          'technical university of dortmund',
          'technical university of madrid',
          'tehran university of medical sciences',
          'texas tech university',
          'the open university',
          'tianjin university',
          'tokai university',
          'tokushima university',
          'tokyo university of agriculture and technology',
          'tokyo university of marine science and technology',
          'tokyo university of science',
          'tomsk polytechnic university',
          'tomsk state university',
          'tongji university',
          'tottori university',
          'toulouse 1 capitole university',
          'toyohashi university of technology',
          'ulster university',
          'united arab emirates university',
          'universiti kebangsaan malaysia',
          'universiti putra malaysia',
          'universiti sains malaysia',
          'universiti teknologi malaysia',
          'universiti teknologi mara',
          'university of a coruña',
          'university of alaska fairbanks',
          'university of alcalá',
          'university of antioquia',
          'university of arkansas',
          'university of belgrade',
          'university of bordeaux',
          'university of bradford',
          'university of brasília',
          'university of bremen',
          'university of brescia',
          'university of brighton',
          'university of bucharest',
          'university of burgundy',
          'university of cagliari',
          'university of calcutta',
          'university of canberra',
          'university of castilla-la mancha',
          'university of catania',
          'university of central lancashire',
          'university of cergy-pontoise',
          'university of chemistry and technology, prague',
          'university of chile',
          'university of coimbra',
          'university of cyprus',
          'university of debrecen',
          'university of delhi',
          'university of dhaka',
          'university of electronic science and technology of china',
          'university of genoa',
          'university of ghana',
          'university of granada',
          'university of greenwich',
          'university of greifswald',
          'university of haifa',
          'university of hamburg',
          'university of hohenheim',
          'university of huddersfield',
          'university of hull',
          'university of ibadan',
          'university of idaho',
          'university of indonesia',
          'university of ioannina',
          'university of jordan',
          'university of kaiserslautern',
          'university of kent',
          'university of kentucky',
          'university of kwazulu-natal',
          'university of la laguna',
          'university of latvia',
          'university of limerick',
          'university of lincoln',
          'university of lisbon',
          'university of ljubljana',
          'university of luxembourg',
          'university of macau',
          'university of mannheim',
          'university of maribor',
          'university of marrakech cadi ayyad',
          'university of medicine and dentistry of new jersey',
          'university of murcia',
          'university of nairobi',
          'university of nantes',
          'university of naples federico ii',
          'university of nebraska medical center',
          'university of neuchâtel',
          'university of new mexico',
          'university of nice sophia antipolis',
          'university of north carolina at greensboro',
          'university of oregon',
          'university of oulu',
          'university of oviedo',
          'university of palermo',
          'university of pardubice',
          'university of paris north – paris 13',
          'university of parma',
          'university of patras',
          'university of pretoria',
          'university of pécs',
          'university of regina',
          'university of rennes 1',
          'university of rome ii – tor vergata',
          'university of rome iii',
          'university of rovira i virgili',
          'university of salamanca',
          'university of salford',
          'university of san francisco',
          'university of santiago de compostela',
          'university of santiago, chile (usach)',
          'university of saskatchewan',
          'university of science and technology beijing',
          'university of seoul',
          'university of seville',
          'university of siena',
          'university of silesia in katowice',
          'university of south africa',
          'university of south dakota',
          'university of southern mississippi',
          'university of southern queensland',
          'university of st gallen',
          'university of stuttgart',
          'university of szeged',
          'university of tehran',
          'university of tennessee, knoxville',
          'university of texas at arlington',
          'university of texas at el paso',
          'university of the basque country',
          'university of the west of england',
          'university of toledo',
          'university of tulsa',
          'university of ulsan',
          'university of urbino carlo bo',
          'university of west bohemia',
          'university of westminster',
          'university of wisconsin',
          'university of wisconsin-milwaukee',
          'university of zaragoza',
          'université de sherbrooke',
          'université du québec à montréal',
          'ural federal university',
          'v.n. karazin kharkiv national university',
          'verona university',
          'vilnius university',
          'všb - technical university of ostrava',
          'warsaw university of technology',
          'west university of timişoara',
          'western sydney university',
          'wuhan university of technology',
          'xiamen university',
          'xidian university',
          'xi’an jiaotong university',
          'yeungnam university',
          'yokohama city university',
          'yokohama national university',
          'yuan ze university',
          'yıldız technical university',
          'örebro university'\}
\end{Verbatim}
            
    \hypertarget{the-universities-that-in-any-year-have-the-same-position-in-all-three-rankings-they-must-have-the-same-position-in-a-year.}{%
\subsubsection{13. The universities that, in any year, have the same
position in all three rankings (they must have the same position in a
year).}\label{the-universities-that-in-any-year-have-the-same-position-in-all-three-rankings-they-must-have-the-same-position-in-a-year.}}

    Si costruisce un dataframe \texttt{full\_rank} andando in join dei
dataset \texttt{times}, \texttt{shangai} e \texttt{cwur} con riferimento
non solo al nome dell'università ma anche con l'anno di riferimento del
ranking. Fatto ciò, si ricerca l'osservazione tale ha fatto registrare
la stessa posizione nei diversi ranking e, per costruzione del dataframe
\texttt{full\_rank}, anche nello stesso anno.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n}{cwur}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{institution}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{cwur}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}68}]:}       world\_rank                                    university\_name  \textbackslash{}
         0              1                                 harvard university   
         1              2              massachusetts institute of technology   
         2              3                                stanford university   
         3              4                            university of cambridge   
         4              5                 california institute of technology   
         5              6                               princeton university   
         6              7                               university of oxford   
         7              8                                    yale university   
         8              9                                columbia university   
         9             10                 university of california, berkeley   
         10            11                              university of chicago   
         11            12                                 cornell university   
         12            13                         university of pennsylvania   
         13            14                                university of tokyo   
         14            15                           johns hopkins university   
         15            16    swiss federal institute of technology in zurich   
         16            17                                   kyoto university   
         17            18                      weizmann institute of science   
         18            19              university of california, los angeles   
         19            20                university of california, san diego   
         20            21                             rockefeller university   
         21            22                     hebrew university of jerusalem   
         22            23                                new york university   
         23            24            university of california, san francisco   
         24            25                    university of wisconsin–madison   
         25            26         university of illinois at urbana–champaign   
         26            27                                    duke university   
         27            28                            imperial college london   
         28            29    university of texas southwestern medical center   
         29            30                      university of texas at austin   
         {\ldots}          {\ldots}                                                {\ldots}   
         2170         971                         fu jen catholic university   
         2171         972                            hunan normal university   
         2172         973  ulsan national institute of science and techno{\ldots}   
         2173         974                  federal university of santa maria   
         2174         975                                shenzhen university   
         2175         976                         tianjin medical university   
         2176         977                   beijing university of technology   
         2177         978              university of reims champagne-ardenne   
         2178         979                                 yuan ze university   
         2179         980     university of chemistry and technology, prague   
         2180         981                             university of limerick   
         2181         982                          china medical university    
         2182         983                               feng chia university   
         2183         984                  zhejiang university of technology   
         2184         985                       novosibirsk state university   
         2185         986                            university of bucharest   
         2186         987                            babeș-bolyai university   
         2187         988                                mansoura university   
         2188         989              university of pau and pays de l'adour   
         2189         990                            henan normal university   
         2190         991                                  xidian university   
         2191         992                        federal university of bahia   
         2192         993                      southwest jiaotong university   
         2193         994                                 ryerson university   
         2194         995                          king abdulaziz university   
         2195         996                          university of the algarve   
         2196         997                              alexandria university   
         2197         998                        federal university of ceará   
         2198         999                             university of a coruña   
         2199        1000                    china pharmaceutical university   
         
                      country  national\_rank  quality\_of\_education  alumni\_employment  \textbackslash{}
         0                USA              1                     7                  9   
         1                USA              2                     9                 17   
         2                USA              3                    17                 11   
         3     United Kingdom              1                    10                 24   
         4                USA              4                     2                 29   
         5                USA              5                     8                 14   
         6     United Kingdom              2                    13                 28   
         7                USA              6                    14                 31   
         8                USA              7                    23                 21   
         9                USA              8                    16                 52   
         10               USA              9                    15                 26   
         11               USA             10                    21                 42   
         12               USA             11                    31                 16   
         13             Japan              1                    32                 19   
         14               USA             12                    34                 77   
         15       Switzerland              1                    26                 66   
         16             Japan              2                    42                 38   
         17            Israel              1                     4                101   
         18               USA             13                    62                 59   
         19               USA             14                    61                101   
         20               USA             15                     1                101   
         21            Israel              2                    24                 93   
         22               USA             16                    89                 75   
         23               USA             17                   101                101   
         24               USA             18                    64                 63   
         25               USA             19                    82                101   
         26               USA             20                    65                 43   
         27    United Kingdom              3                    84                 73   
         28               USA             21                    19                101   
         29               USA             22                   101                 78   
         {\ldots}              {\ldots}            {\ldots}                   {\ldots}                {\ldots}   
         2170          Taiwan             19                   367                446   
         2171           China             74                   367                567   
         2172     South Korea             36                   367                567   
         2173          Brazil             16                   367                396   
         2174           China             75                   367                410   
         2175           China             76                   367                567   
         2176           China             77                   367                567   
         2177          France             48                   367                567   
         2178          Taiwan             20                   367                567   
         2179  Czech Republic              5                   367                567   
         2180         Ireland              8                   367                529   
         2181           China             78                   367                567   
         2182          Taiwan             21                   367                434   
         2183           China             79                   367                567   
         2184          Russia              5                   167                567   
         2185         Romania              1                   237                567   
         2186         Romania              2                   367                567   
         2187           Egypt              3                   367                567   
         2188          France             49                   367                567   
         2189           China             80                   367                567   
         2190           China             81                   367                542   
         2191          Brazil             17                   367                540   
         2192           China             82                   367                327   
         2193          Canada             33                   367                567   
         2194    Saudi Arabia              4                   367                449   
         2195        Portugal              7                   367                567   
         2196           Egypt              4                   236                566   
         2197          Brazil             18                   367                549   
         2198           Spain             40                   367                567   
         2199           China             83                   367                567   
         
               quality\_of\_faculty  publications  influence  citations  broad\_impact  \textbackslash{}
         0                      1             1          1          1           NaN   
         1                      3            12          4          4           NaN   
         2                      5             4          2          2           NaN   
         3                      4            16         16         11           NaN   
         4                      7            37         22         22           NaN   
         5                      2            53         33         26           NaN   
         6                      9            15         13         19           NaN   
         7                     12            14          6         15           NaN   
         8                     10            13         12         14           NaN   
         9                      6             6          5          3           NaN   
         10                     8            34         20         28           NaN   
         11                    14            22         21         16           NaN   
         12                    24             9         10          8           NaN   
         13                    31             8         19         23           NaN   
         14                    20            11          9          9           NaN   
         15                    11            40         51         44           NaN   
         16                    19            25         36         43           NaN   
         17                    22           101         67        101           NaN   
         18                    23             3         11          6           NaN   
         19                    15            10          8         10           NaN   
         20                    16           101         28         96           NaN   
         21                    13           101         91        101           NaN   
         22                    17            42         24         34           NaN   
         23                    21            19          3         13           NaN   
         24                    33            17         30         21           NaN   
         25                    18            35         71         39           NaN   
         26                    55            20         15         12           NaN   
         27                    35            26         26         29           NaN   
         28                    32           101         43         84           NaN   
         29                    27            41         47         40           NaN   
         {\ldots}                  {\ldots}           {\ldots}        {\ldots}        {\ldots}           {\ldots}   
         2170                 218           984        887        812         958.0   
         2171                 218           923        917        812         932.0   
         2172                 218           880        912        645         984.0   
         2173                 218           954        974        812         975.0   
         2174                 218           976        778        645         999.0   
         2175                 218           885        857        812         946.0   
         2176                 218           780        950        812         969.0   
         2177                 218           967        884        645         958.0   
         2178                 218           923        984        812         946.0   
         2179                 218           991        868        812         946.0   
         2180                 218           892        863        812         969.0   
         2181                 218           804        749        645         958.0   
         2182                 218           902        991        812         975.0   
         2183                 218           858        991        812         958.0   
         2184                 218           819        858        645         991.0   
         2185                 218           845        804        645         975.0   
         2186                 218           874        855        812         958.0   
         2187                 218           987        969        645         958.0   
         2188                 218           980        991        812         958.0   
         2189                 218           959        991        812         958.0   
         2190                 218           830        974        812         984.0   
         2191                 218           962        865        645         969.0   
         2192                 218           937        962        812         998.0   
         2193                 218           811        969        511         975.0   
         2194                 218           595        430        645         994.0   
         2195                 218           926        845        812         969.0   
         2196                 218           997        908        645         981.0   
         2197                 218           830        823        812         975.0   
         2198                 218           886        974        812         975.0   
         2199                 218           861        991        812         981.0   
         
               patents   score  year  
         0           5  100.00  2012  
         1           1   91.67  2012  
         2          15   89.50  2012  
         3          50   86.17  2012  
         4          18   85.21  2012  
         5         101   82.50  2012  
         6          26   82.34  2012  
         7          66   79.14  2012  
         8           5   78.86  2012  
         9          16   78.55  2012  
         10        101   73.82  2012  
         11         10   73.69  2012  
         12          9   73.64  2012  
         13          3   69.49  2012  
         14          7   66.94  2012  
         15         34   66.69  2012  
         16         23   65.76  2012  
         17         29   65.09  2012  
         18         13   64.05  2012  
         19         22   63.11  2012  
         20        101   61.74  2012  
         21         28   60.76  2012  
         22         62   60.55  2012  
         23         33   59.70  2012  
         24         21   59.66  2012  
         25         44   59.00  2012  
         26         20   58.37  2012  
         27         41   57.53  2012  
         28        101   56.43  2012  
         29         57   56.18  2012  
         {\ldots}       {\ldots}     {\ldots}   {\ldots}  
         2170      824   44.06  2015  
         2171      871   44.06  2015  
         2172      349   44.06  2015  
         2173      871   44.05  2015  
         2174      318   44.05  2015  
         2175      839   44.05  2015  
         2176      512   44.05  2015  
         2177      544   44.05  2015  
         2178      871   44.05  2015  
         2179      778   44.05  2015  
         2180      516   44.05  2015  
         2181      871   44.04  2015  
         2182      871   44.04  2015  
         2183      672   44.04  2015  
         2184      871   44.04  2015  
         2185      871   44.04  2015  
         2186      871   44.04  2015  
         2187      871   44.04  2015  
         2188      809   44.04  2015  
         2189      871   44.04  2015  
         2190      434   44.03  2015  
         2191      774   44.03  2015  
         2192      861   44.03  2015  
         2193      756   44.03  2015  
         2194      839   44.03  2015  
         2195      816   44.03  2015  
         2196      871   44.03  2015  
         2197      824   44.03  2015  
         2198      651   44.02  2015  
         2199      547   44.02  2015  
         
         [2200 rows x 14 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{full\PYZus{}rank} \PY{o}{=} \PY{n}{times}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{cwur}\PY{p}{,} \PY{n}{on} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{how} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}} \PY{p}{)}
         \PY{n}{full\PYZus{}rank} \PY{o}{=} \PY{n}{full\PYZus{}rank}\PY{o}{.}\PY{n}{merge}\PY{p}{(} \PY{n}{shangai}\PY{p}{,} \PY{n}{on} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{how} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}} \PY{p}{)}
         \PY{n}{full\PYZus{}rank}\PY{o}{.}\PY{n}{rename}\PY{p}{(} \PY{n}{columns} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{times\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank\PYZus{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cwur\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{world\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shangai\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True} \PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cwur\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cwur\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{tmp\PYZus{}merged} \PY{o}{=} \PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{p}{(}\PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{times\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cwur\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cwur\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{full\PYZus{}rank}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shangai\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{tmp\PYZus{}merged}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{university\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{times\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cwur\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shangai\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:}         university\_name  year times\_rank cwur\_rank shangai\_rank
         60  stanford university  2013          2         2            2
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{n}{end} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Il processo complessivo è stato ultimato in }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ secondi.}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{end}\PY{o}{\PYZhy{}}\PY{n}{start}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Il processo complessivo è stato ultimato in 9 secondi.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
